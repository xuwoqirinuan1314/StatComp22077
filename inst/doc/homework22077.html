<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="22077" />

<meta name="date" content="2022-12-09" />

<title>Homework of 22077</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Homework of 22077</h1>
<h4 class="author">22077</h4>
<h4 class="date">2022-12-09</h4>



<div id="a-22077-2022-09-09" class="section level1">
<h1>A-22077-2022-09-09</h1>
<div id="question" class="section level2">
<h2>Question</h2>
<p>Use knitr to produce at least 3 examples(texts,figures,tables)</p>
</div>
<div id="answer" class="section level2">
<h2>Answer</h2>
<p>texts:</p>
<p>This is an R Markdown presentation. Markdown is a simple formatting
syntax for authoring HTML, PDF, and MS Word documents.</p>
<p>When you click the <strong>Knit</strong> button a document will be
generated that includes both content as well as the output of any
embedded R code chunks within the document.</p>
<p>figures:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(iris)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>tables:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(iris)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(iris,<span class="dv">15</span>)</span></code></pre></div>
<pre><code>##    Sepal.Length Sepal.Width Petal.Length Petal.Width Species
## 1           5.1         3.5          1.4         0.2  setosa
## 2           4.9         3.0          1.4         0.2  setosa
## 3           4.7         3.2          1.3         0.2  setosa
## 4           4.6         3.1          1.5         0.2  setosa
## 5           5.0         3.6          1.4         0.2  setosa
## 6           5.4         3.9          1.7         0.4  setosa
## 7           4.6         3.4          1.4         0.3  setosa
## 8           5.0         3.4          1.5         0.2  setosa
## 9           4.4         2.9          1.4         0.2  setosa
## 10          4.9         3.1          1.5         0.1  setosa
## 11          5.4         3.7          1.5         0.2  setosa
## 12          4.8         3.4          1.6         0.2  setosa
## 13          4.8         3.0          1.4         0.1  setosa
## 14          4.3         3.0          1.1         0.1  setosa
## 15          5.8         4.0          1.2         0.2  setosa</code></pre>
</div>
</div>
<div id="a-22077-2022-09-15" class="section level1">
<h1>A-22077-2022-09-15</h1>
<div id="exercises-3.3" class="section level2">
<h2>Exercises 3.3</h2>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>u <span class="ot">&lt;-</span> <span class="fu">runif</span>(n)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="dv">2</span><span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>u)<span class="sc">^</span>(<span class="sc">-</span><span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(x, <span class="at">prob =</span> <span class="cn">TRUE</span>,<span class="at">breaks =</span> <span class="dv">1000</span>,<span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">8</span>),<span class="at">main =</span> <span class="fu">expression</span>(<span class="fu">f</span>(x)<span class="sc">==</span><span class="dv">8</span><span class="sc">*</span>x<span class="sc">^</span>(<span class="sc">-</span><span class="dv">3</span>)),<span class="at">border =</span> <span class="st">&quot;red&quot;</span>) <span class="co">#density histogram of sample</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">2</span>, <span class="dv">8</span>, .<span class="dv">001</span>)</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(y, <span class="dv">8</span><span class="sc">*</span>y<span class="sc">^</span>(<span class="sc">-</span><span class="dv">3</span>))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co">#density curve f(x)</span></span></code></pre></div>
</div>
<div id="exercise-3.7" class="section level2">
<h2>Exercise 3.7</h2>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fl">1e4</span>;j<span class="ot">&lt;-</span>k<span class="ot">&lt;-</span><span class="dv">0</span>;y <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="cf">while</span> (k <span class="sc">&lt;</span> n) {</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>  u <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">1</span>)</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>  j <span class="ot">&lt;-</span> j <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">1</span>) <span class="co">#random variate from g(.)</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> ((<span class="dv">16</span><span class="sc">/</span><span class="dv">9</span>)<span class="sc">*</span>x<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>x) <span class="sc">&gt;</span> u) {</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>    <span class="co">#we accept x</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>    k <span class="ot">&lt;-</span> k <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>    y[k] <span class="ot">&lt;-</span> x</span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(y, <span class="at">prob =</span> <span class="cn">TRUE</span>,<span class="at">breaks =</span> <span class="dv">50</span>,<span class="at">border =</span> <span class="st">&quot;red&quot;</span>,<span class="at">main =</span> <span class="fu">expression</span>(<span class="fu">f</span>(x)<span class="sc">==</span><span class="dv">12</span><span class="sc">*</span>x<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>x)),)</span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>z <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, .<span class="dv">01</span>)</span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(z, <span class="dv">12</span><span class="sc">*</span>z<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>z))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co">#density curve f(x)</span></span></code></pre></div>
</div>
<div id="exercise-3.12" class="section level2">
<h2>Exercise 3.12</h2>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fl">1e3</span>; r <span class="ot">&lt;-</span> <span class="dv">4</span>; beta <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>lambda <span class="ot">&lt;-</span> <span class="fu">rgamma</span>(n, r, beta)</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rexp</span>(n, lambda) <span class="co"># the length of lambda = n</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(x,<span class="at">breaks =</span> <span class="dv">400</span>,<span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">5</span>),<span class="at">borde =</span> <span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="exercise-3.13" class="section level2">
<h2>Exercise 3.13</h2>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fl">1e4</span>; r <span class="ot">&lt;-</span> <span class="dv">4</span>; beta <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>lambda <span class="ot">&lt;-</span> <span class="fu">rgamma</span>(n, r, beta)</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rexp</span>(n, lambda) <span class="co"># the length of lambda = n</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(x,<span class="at">prob =</span> <span class="cn">TRUE</span>,<span class="at">breaks =</span> <span class="dv">400</span>,<span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">5</span>),<span class="at">borde =</span> <span class="st">&quot;red&quot;</span>,<span class="at">main =</span> <span class="fu">expression</span>(<span class="fu">f</span>(x)<span class="sc">==</span><span class="dv">64</span><span class="sc">*</span>(<span class="dv">2</span><span class="sc">+</span>x)<span class="sc">^</span>(<span class="sc">-</span><span class="dv">5</span>)))</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>z <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">5</span>, .<span class="dv">01</span>)</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(z, <span class="dv">64</span><span class="sc">*</span>(<span class="dv">2</span><span class="sc">+</span>z)<span class="sc">^</span>(<span class="sc">-</span><span class="dv">5</span>))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
</div>
<div id="a-22077-2022-09-23" class="section level1">
<h1>A-22077-2022-09-23</h1>
<div id="qusetion" class="section level2">
<h2>Qusetion</h2>
<ol style="list-style-type: decimal">
<li>For <span class="math inline">\(n = 10^4\)</span>, <span class="math inline">\(2 × 10^4\)</span>, <span class="math inline">\(4 ×
10^4\)</span>, <span class="math inline">\(6 × 10^4\)</span>, <span class="math inline">\(8 × 10^4\)</span>, apply the fast sorting
algorithm to randomly permuted numbers of 1,…, n. (1)Calculate
computation time averaged over 100 simulations, denoted by an.
(2)Regress an on tn := n log(n), and graphically show the results
(scatter plot and regression line).</li>
<li>Exercises 5.6, 5.7(pages 149-151, Statistical Computing with
R).</li>
</ol>
</div>
<div id="answer-1" class="section level2">
<h2>Answer</h2>
<p>Question 1</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>quick_sort<span class="ot">&lt;-</span><span class="cf">function</span>(x){</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>  num<span class="ot">&lt;-</span><span class="fu">length</span>(x)</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(num<span class="sc">==</span><span class="dv">0</span><span class="sc">||</span>num<span class="sc">==</span><span class="dv">1</span>){<span class="fu">return</span>(x)</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>  }<span class="cf">else</span>{</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>    a<span class="ot">&lt;-</span>x[<span class="dv">1</span>]</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>    y<span class="ot">&lt;-</span>x[<span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>    lower<span class="ot">&lt;-</span>y[y<span class="sc">&lt;</span>a]</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>    upper<span class="ot">&lt;-</span>y[y<span class="sc">&gt;=</span>a]</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">c</span>(<span class="fu">quick_sort</span>(lower),a,<span class="fu">quick_sort</span>(upper)))}</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>test<span class="ot">&lt;-</span><span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="fl">1e4</span>)</span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>ans <span class="ot">&lt;-</span> <span class="dv">0</span>               </span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>) {</span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a>  w<span class="ot">&lt;-</span><span class="fu">system.time</span>(<span class="fu">quick_sort</span>(test))[<span class="dv">1</span>]</span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a>  ans <span class="ot">&lt;-</span> ans <span class="sc">+</span> w    </span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a>a1<span class="ot">=</span>ans<span class="sc">/</span><span class="dv">100</span></span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a>a1</span></code></pre></div>
<pre><code>## user.self 
##    0.0197</code></pre>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>test<span class="ot">&lt;-</span><span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="fl">2e4</span>)</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>ans <span class="ot">&lt;-</span> <span class="dv">0</span>               </span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>) {</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>  w<span class="ot">&lt;-</span><span class="fu">system.time</span>(<span class="fu">quick_sort</span>(test))[<span class="dv">1</span>]</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>  ans <span class="ot">&lt;-</span> ans <span class="sc">+</span> w    </span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>a2<span class="ot">=</span>ans<span class="sc">/</span><span class="dv">100</span></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>a2</span></code></pre></div>
<pre><code>## user.self 
##    0.0372</code></pre>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>test<span class="ot">&lt;-</span><span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="fl">4e4</span>)</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>ans <span class="ot">&lt;-</span> <span class="dv">0</span>               </span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>) {</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>  w<span class="ot">&lt;-</span><span class="fu">system.time</span>(<span class="fu">quick_sort</span>(test))[<span class="dv">1</span>]</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>  ans <span class="ot">&lt;-</span> ans <span class="sc">+</span> w    </span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>a3<span class="ot">=</span>ans<span class="sc">/</span><span class="dv">100</span></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>a3</span></code></pre></div>
<pre><code>## user.self 
##    0.0796</code></pre>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>test<span class="ot">&lt;-</span><span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="fl">6e4</span>)</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>ans <span class="ot">&lt;-</span> <span class="dv">0</span>               </span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>) {</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>  w<span class="ot">&lt;-</span><span class="fu">system.time</span>(<span class="fu">quick_sort</span>(test))[<span class="dv">1</span>]</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>  ans <span class="ot">&lt;-</span> ans <span class="sc">+</span> w    </span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>a4<span class="ot">=</span>ans<span class="sc">/</span><span class="dv">100</span></span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>a4</span></code></pre></div>
<pre><code>## user.self 
##    0.1204</code></pre>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>test<span class="ot">&lt;-</span><span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="fl">8e4</span>)</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>ans <span class="ot">&lt;-</span> <span class="dv">0</span>               </span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>) {</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>  w<span class="ot">&lt;-</span><span class="fu">system.time</span>(<span class="fu">quick_sort</span>(test))[<span class="dv">1</span>]</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>  ans <span class="ot">&lt;-</span> ans <span class="sc">+</span> w    </span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>a5<span class="ot">=</span>ans<span class="sc">/</span><span class="dv">100</span></span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>a5</span></code></pre></div>
<pre><code>## user.self 
##    0.1633</code></pre>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>an<span class="ot">&lt;-</span><span class="fu">c</span>(a1,a2,a3,a4,a5)</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>tn<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="fl">1e4</span><span class="sc">*</span><span class="fu">log</span>(<span class="fl">1e4</span>),<span class="fl">2e4</span><span class="sc">*</span><span class="fu">log</span>(<span class="fl">2e4</span>),<span class="fl">4e4</span><span class="sc">*</span><span class="fu">log</span>(<span class="fl">1e4</span>),<span class="fl">6e4</span><span class="sc">*</span><span class="fu">log</span>(<span class="fl">6e4</span>),<span class="fl">8e4</span><span class="sc">*</span><span class="fu">log</span>(<span class="fl">8e4</span>))</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>model<span class="ot">&lt;-</span><span class="fu">lm</span>(an<span class="sc">~</span>tn)</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(tn,an)</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(model,)</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAUVBMVEUAAAAAADoAAGYAOpAAZrY6AAA6ADo6AGY6Ojo6kNtmAABmADpmtrZmtv+QOgCQ2/+2ZgC2/7a2///bkDrb/7bb////tmb/25D//7b//9v////4W4PIAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAHDElEQVR4nO2di3ajNhRF8cRpa7dJ6NAQR///obUQYOwABwlddGXOXklWZoIlsdETCVEYMkuROgHaoSAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBgMiCimxIJShucAJYN4VHQvcmyLopDAVNUQy+Fn8icgJUU3TZh4LGKbqfFDSGq59NgjrIv/VMQZO4No3MQT+4v3gU9Egx+8/Fn4ucDDX8KPsUNGSkaqSgAWOJoqCe8ZaVgjomUkRBjsmOGQU1TCeHgsxM9jEUZJlNCwWBYeHuBaGE7Hw0j9Ox7xy0IBV7FrQoG+9Y0LIk7FbQ0lpwr4Lin/dTCfJoRHcpyCfyHQry64PtT5BnzHsT5N2F35GgsBHOfgQVAdnH7EhQ0ehRn4PSjeY9Z9pvn4t+YMP3u9Pw63eU4NbTXhEtgqri5H6pu19WBbeetnRpqYO+33st1cvn6uBW0xavoHItIuhyfut+rScK2ZaCVsX1/DloZXsgVQe1WSh9HbQ2IqFW7HJ2rdhE/tlM0PruxHN3FCPE8syCovRGn1hQpL7/ttFJBTcSQaQYhPpBtzFXon5QtPADBMFxlj1k5o9+8QYRcSwcIKhEJ2+soWOkeEOIGbi/oMt5ou93R128jf33Frc74oYdImj01KXiTR2yvyBYeuLG6xtu7IAD6qCJ0iMUb+pgQ4rYfAN+T7VlMy9Rsz1RR1Gm4n8eQakL7e3ArowtKmKr410anlit739g+fJZHc3X61xVvfWshoJew11HsX75nLyZatl4VkO02+l9oO0ofv35u/meYON70jqGLYOO4slc/v6YEyQ7q/EwThGepA2og2zXpjzNFTHRHPQwAajmvsngwPJoW7K5RkxwVuN+Cll+jn/jWY31o/k7QZpu3GpplweCNlkikp2gWx2kbOZIjaBu55qtph6jH7hNcPqmrlUJ2nCBWpaCttOTpaBt1zfmJ2hTPfkJ2nx5bGaCttaTmaAUz0rnJCiBnpwEJXrUPhdByXYi2FhQ6O2OVHoyyUEpN7LIQVBCPTkISrwPinpBafWoF5R+Gx3dgpLr0S0offYxqgVp0KNYkIrsY/QKUqJHqyAt2ccoFaRHj0ZBarYQdAgJqq6n2SzweFgGjEfzYRtIyCEjqDp8mMvZrsj3XScduoOEGCKC3AKq73e7ktFPUPAOEmKICOqW4Nn1sD6C2heiPL+gfgleefQR1JcuRX6k6qBWy/RKvZ/BdfX2XloxV8gmn818DE6XlQFK+kFa9SgRpDb7GDFBXs9qKNYjVkl7PKuhOfsY6WYerLQv+o6PXkQ7imb+WY1CffYxSXNQ/6UaqTpo4lmN4Wi+f1OnaoRasSU7UKkbdo2SrB80eFOnapJ2FJUNu0aRFrTpxgISJCximZBI0PqYos7uRzg7CooaxIJtvNbGlLUgPFhdH1POghYMNdbHlLOgBYPV9THlLIg5CIE3FlgfU9aC8GB1fUx5C9ohFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCCAhqLlzPXE/pC6Kw4fp7gss2SX+63XyOP/A/BEQ9P1+TXU1nt76+if7bb7++FgWmt2A163ujxBYAAKC3I7Lo3Ov7p5keVx+z9Z9IlJgIYjVQc2lrfqy5i7yzV21sEAMMsf6wEIQE2Rf9GIffvl6bU6qPafmp73g5V/T9dSQ+te/Z3dghMBCkBJk71q7l724/N+ezaH9eTnbu7YlPqnKTlLad37ECCwEIUG1raPdGVxLgm2ILG/9ObVH4bqjOrTZJEZgIcgIcrMedbuQwlYVj6WiYX4D/QZXPV8PjBFYCCKC2inq/uKan/Xq4D9n6ctUjMBCkBDUTZ8N36fkkt+3zO7kFpQKF8b1wBiBhSDSD+qqy6YCKQeX/ta3s92XRfWqncNtVMQILAABQZWrLLp+0P2FrdrRgSnb+gRSd014jMD84WAVQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgIoF1QLzbgvR7eg4ZqXRFAQQLUguxzx5b/zP2exxS0Y1YKaHHQ524X7B5H1dQvIQdBJbIXmAnIQ9JayMqIgAAUBKAigXdCJgmYpbT+IgjRDQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUB/gekNlSSxZbJ2gAAAABJRU5ErkJggg==" /><!-- --></p>
<p>Question 2: Exercise 5.6</p>
<p><span class="math inline">\(Cov(e^{U},e^{1-U})=e-(e-1)^2=-0.2342106,Var(e^{U}+e^{1-U})=Var(e^{U})+Var(e^{1-U})+2Cov(e^{U},e^{1-U})=0.01564999\)</span>.Before
this process,we compute <span class="math inline">\(Var(e^{U})=0.2420351\)</span>,so that the percent
reduction in variance of <span class="math inline">\(\hat{θ}\)</span> is
<span class="math inline">\((0.2420351-0.01564999)/0.2420351\)</span>
<span class="math inline">\(=0.93534\)</span>.</p>
<p>Question 2: Exercise 5.7</p>
<p>In this part,we calculate the empirical estimate of the percent
reduction in variance using the antithetic variate is about 0.98 ,which
is larger than the theoretical value from Exercise 5.6 <span class="math inline">\(0.93534\)</span>.</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fl">1e4</span>; x <span class="ot">&lt;-</span> <span class="fu">runif</span>(m, <span class="at">min=</span><span class="dv">0</span>, <span class="at">max=</span><span class="dv">1</span>)</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>theta.hat1 <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">exp</span>(x))</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>theta.hat1</span></code></pre></div>
<pre><code>## [1] 1.725289</code></pre>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>theta.hat2 <span class="ot">&lt;-</span> <span class="fu">mean</span>((<span class="fu">exp</span>(x)<span class="sc">+</span><span class="fu">exp</span>(<span class="dv">1</span><span class="sc">-</span>x))<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>theta.hat2</span></code></pre></div>
<pre><code>## [1] 1.717425</code></pre>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>var1<span class="ot">&lt;-</span><span class="fu">mean</span>(<span class="fu">exp</span>(<span class="dv">2</span><span class="sc">*</span>x)<span class="sc">-</span>(theta.hat1)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>var1</span></code></pre></div>
<pre><code>## [1] 0.2397231</code></pre>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>var2<span class="ot">&lt;-</span><span class="fu">mean</span>((<span class="fu">exp</span>(x)<span class="sc">+</span><span class="fu">exp</span>(<span class="dv">1</span><span class="sc">-</span>x))<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">4</span><span class="sc">-</span>(theta.hat2)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>var2</span></code></pre></div>
<pre><code>## [1] 0.003872153</code></pre>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>r<span class="ot">&lt;-</span>(var1<span class="sc">-</span>var2)<span class="sc">/</span>var1</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>r</span></code></pre></div>
<pre><code>## [1] 0.9838474</code></pre>
</div>
</div>
<div id="a-22077-2022-09-30" class="section level1">
<h1>A-22077-2022-09-30</h1>
<div id="question-1" class="section level2">
<h2>Question</h2>
<p>Exercises 5.13, 5.15(pages 149-151, Statistical Computing with
R).</p>
<p>There is something wrong with the subintervals in Exercise 5.15
(Example 5.13). You may modify it without losing the original
intent.</p>
</div>
<div id="answer-2" class="section level2">
<h2>Answer</h2>
<div id="exercise-5.13" class="section level3">
<h3>Exercise 5.13</h3>
<p>The integration which we want to estimate is <span class="math display">\[\int_1^{\infty} \frac{x^2}{\sqrt{2 \pi}} e^{-x^2
/ 2} d x.\]</span> We can use the method of change of variable to change
the integration to become another integration: <span class="math display">\[\int_1^{\infty} \frac1 2\frac{t^{1/2}}{\sqrt{2
\pi}} e^{-t/2} d t\]</span>. Based on the integration which we have
transformd,we can choose <span class="math display">\[{(\frac1
2)}^{3/2}\frac{(x-1)^{1/2}}{\Gamma(\frac32)} e^{\frac{-x+1}2}\]</span>
as <span class="math inline">\(f_1\)</span>,and we choose</p>
<p><span class="math display">\[\frac12e^{-\frac{x-1}2}\]</span> as
<span class="math inline">\(f_2\)</span>.</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">rgamma</span>(<span class="fl">1e4</span>,<span class="dv">3</span><span class="sc">/</span><span class="dv">2</span>,<span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>)<span class="sc">+</span><span class="dv">1</span><span class="co"># the random value of f1</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="dv">2</span>)<span class="sc">*</span>n<span class="sc">^</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>)<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>n<span class="sc">/</span><span class="dv">2</span>)<span class="sc">/</span>(n<span class="dv">-1</span>)<span class="sc">^</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>)<span class="sc">/</span><span class="fu">exp</span>(<span class="sc">-</span>(n<span class="dv">-1</span>)<span class="sc">/</span><span class="dv">2</span>)<span class="sc">*</span><span class="fu">gamma</span>(<span class="dv">3</span><span class="sc">/</span><span class="dv">2</span>)<span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">2</span><span class="sc">*</span>pi)<span class="co"># the random value of g/f1</span></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">mean</span>(m)<span class="co"># the mean of samples of g/f1</span></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>q <span class="ot">&lt;-</span> (m<span class="sc">-</span>p)<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>r <span class="ot">&lt;-</span> <span class="fu">mean</span>(q)<span class="co"># the variance produced by f1</span></span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>r</span></code></pre></div>
<pre><code>## [1] 0.02153701</code></pre>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="fl">1e4</span>)</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>n0 <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">2</span><span class="sc">*</span><span class="fu">log</span>(<span class="dv">1</span><span class="sc">-</span>n)<span class="sc">+</span><span class="dv">1</span><span class="co"># the random value of f2</span></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">exp</span>(<span class="sc">-</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>))<span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">2</span><span class="sc">*</span>pi)<span class="sc">*</span>n0<span class="sc">^</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>)<span class="co"># the random value of g/f2</span></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">mean</span>(m)<span class="co"># the mean of samples of g/f2</span></span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>q <span class="ot">&lt;-</span> (m<span class="sc">-</span>p)<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>r <span class="ot">&lt;-</span> <span class="fu">mean</span>(q)<span class="co"># the variance produced by f2</span></span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a>r</span></code></pre></div>
<pre><code>## [1] 0.0144787</code></pre>
<p>Though the r code above,we calculate the variance produced by <span class="math inline">\(f_1\)</span> is much larger than the variance
produced by <span class="math inline">\(f_2\)</span>.</p>
</div>
<div id="exercise-5.15" class="section level3">
<h3>Exercise 5.15</h3>
<p>We set the CDF of <span class="math inline">\(f_i(x)\)</span> is
<span class="math inline">\(F_i(x)\)</span>,we choose <span class="math inline">\(\frac{e^{-x}}{1-e^{-1}}\)</span> as <span class="math inline">\(f\)</span>,though calculation,we have got the
expression of <span class="math inline">\(F_i(x)\)</span> is <span class="math display">\[F_i(x)=\frac{5-(1-e^{-1})(i-1)-5e^{-x}}{1-e^{-1}}.\]</span>
And based the expression of <span class="math inline">\(F_i(x)\)</span>,we can get the inverse function of
<span class="math inline">\(F_i(x)\)</span>,we name them as <span class="math inline">\(R_i(x)\)</span>,the expression of <span class="math inline">\(R_i(x)\)</span> are as follows: <span class="math display">\[G_i(x)=-log{\frac{5-(1-e^{-1})(i-1)-(1-e^{-1})x}5}.\]</span>
Based on above,we can get the random numbers of <span class="math inline">\(X_i\)</span>,which follows <span class="math inline">\(F_i(x)\)</span>.And then,we can further get the
observed value of <span class="math inline">\(\hat{\theta_i}\)</span>
and the estimator of variance of <span class="math inline">\(\hat{\theta_i}\)</span>.</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span><span class="fu">runif</span>(<span class="dv">2000</span>)</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>n01 <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fu">log</span>((<span class="dv">5</span><span class="sc">-</span>(<span class="dv">1</span><span class="sc">-</span><span class="fu">exp</span>(<span class="sc">-</span><span class="dv">1</span>))<span class="sc">*</span>(<span class="dv">1-1</span>)<span class="sc">-</span>(<span class="dv">1</span><span class="sc">-</span><span class="fu">exp</span>(<span class="sc">-</span><span class="dv">1</span>))<span class="sc">*</span>n)<span class="sc">/</span><span class="dv">5</span>)</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>n02 <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fu">log</span>((<span class="dv">5</span><span class="sc">-</span>(<span class="dv">1</span><span class="sc">-</span><span class="fu">exp</span>(<span class="sc">-</span><span class="dv">1</span>))<span class="sc">*</span>(<span class="dv">2-1</span>)<span class="sc">-</span>(<span class="dv">1</span><span class="sc">-</span><span class="fu">exp</span>(<span class="sc">-</span><span class="dv">1</span>))<span class="sc">*</span>n)<span class="sc">/</span><span class="dv">5</span>)</span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>n03 <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fu">log</span>((<span class="dv">5</span><span class="sc">-</span>(<span class="dv">1</span><span class="sc">-</span><span class="fu">exp</span>(<span class="sc">-</span><span class="dv">1</span>))<span class="sc">*</span>(<span class="dv">3-1</span>)<span class="sc">-</span>(<span class="dv">1</span><span class="sc">-</span><span class="fu">exp</span>(<span class="sc">-</span><span class="dv">1</span>))<span class="sc">*</span>n)<span class="sc">/</span><span class="dv">5</span>)</span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>n04 <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fu">log</span>((<span class="dv">5</span><span class="sc">-</span>(<span class="dv">1</span><span class="sc">-</span><span class="fu">exp</span>(<span class="sc">-</span><span class="dv">1</span>))<span class="sc">*</span>(<span class="dv">4-1</span>)<span class="sc">-</span>(<span class="dv">1</span><span class="sc">-</span><span class="fu">exp</span>(<span class="sc">-</span><span class="dv">1</span>))<span class="sc">*</span>n)<span class="sc">/</span><span class="dv">5</span>)</span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>n05 <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fu">log</span>((<span class="dv">5</span><span class="sc">-</span>(<span class="dv">1</span><span class="sc">-</span><span class="fu">exp</span>(<span class="sc">-</span><span class="dv">1</span>))<span class="sc">*</span>(<span class="dv">5-1</span>)<span class="sc">-</span>(<span class="dv">1</span><span class="sc">-</span><span class="fu">exp</span>(<span class="sc">-</span><span class="dv">1</span>))<span class="sc">*</span>n)<span class="sc">/</span><span class="dv">5</span>)</span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a>m1 <span class="ot">&lt;-</span> (<span class="dv">1</span><span class="sc">-</span><span class="fu">exp</span>(<span class="sc">-</span><span class="dv">1</span>))<span class="sc">/</span>(<span class="dv">1</span><span class="sc">+</span>n01<span class="sc">^</span><span class="dv">2</span>)<span class="sc">/</span><span class="dv">5</span></span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a>m2 <span class="ot">&lt;-</span> (<span class="dv">1</span><span class="sc">-</span><span class="fu">exp</span>(<span class="sc">-</span><span class="dv">1</span>))<span class="sc">/</span>(<span class="dv">1</span><span class="sc">+</span>n02<span class="sc">^</span><span class="dv">2</span>)<span class="sc">/</span><span class="dv">5</span></span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a>m3 <span class="ot">&lt;-</span> (<span class="dv">1</span><span class="sc">-</span><span class="fu">exp</span>(<span class="sc">-</span><span class="dv">1</span>))<span class="sc">/</span>(<span class="dv">1</span><span class="sc">+</span>n03<span class="sc">^</span><span class="dv">2</span>)<span class="sc">/</span><span class="dv">5</span></span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a>m4 <span class="ot">&lt;-</span> (<span class="dv">1</span><span class="sc">-</span><span class="fu">exp</span>(<span class="sc">-</span><span class="dv">1</span>))<span class="sc">/</span>(<span class="dv">1</span><span class="sc">+</span>n04<span class="sc">^</span><span class="dv">2</span>)<span class="sc">/</span><span class="dv">5</span></span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a>m5 <span class="ot">&lt;-</span> (<span class="dv">1</span><span class="sc">-</span><span class="fu">exp</span>(<span class="sc">-</span><span class="dv">1</span>))<span class="sc">/</span>(<span class="dv">1</span><span class="sc">+</span>n05<span class="sc">^</span><span class="dv">2</span>)<span class="sc">/</span><span class="dv">5</span></span>
<span id="cb35-12"><a href="#cb35-12" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">mean</span>(m1)<span class="sc">+</span><span class="fu">mean</span>(m2)<span class="sc">+</span><span class="fu">mean</span>(m3)<span class="sc">+</span><span class="fu">mean</span>(m4)<span class="sc">+</span><span class="fu">mean</span>(m5)</span>
<span id="cb35-13"><a href="#cb35-13" aria-hidden="true" tabindex="-1"></a>r <span class="ot">&lt;-</span> <span class="fu">mean</span>((m1<span class="sc">-</span><span class="fu">mean</span>(m1))<span class="sc">^</span><span class="dv">2</span>)<span class="sc">+</span><span class="fu">mean</span>((m2<span class="sc">-</span><span class="fu">mean</span>(m2))<span class="sc">^</span><span class="dv">2</span>)<span class="sc">+</span><span class="fu">mean</span>((m3<span class="sc">-</span><span class="fu">mean</span>(m3))<span class="sc">^</span><span class="dv">2</span>)<span class="sc">+</span><span class="fu">mean</span>((m4<span class="sc">-</span><span class="fu">mean</span>(m4))<span class="sc">^</span><span class="dv">2</span>)<span class="sc">+</span><span class="fu">mean</span>((m5<span class="sc">-</span><span class="fu">mean</span>(m5))<span class="sc">^</span><span class="dv">2</span>)<span class="co">#the variance got by Stratified Importance Sampling</span></span>
<span id="cb35-14"><a href="#cb35-14" aria-hidden="true" tabindex="-1"></a>r</span></code></pre></div>
<pre><code>## [1] 8.547099e-05</code></pre>
<p>And then, we can see the result of Example 5.10.</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>g <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">exp</span>(<span class="sc">-</span>x <span class="sc">-</span> <span class="fu">log</span>(<span class="dv">1</span><span class="sc">+</span>x<span class="sc">^</span><span class="dv">2</span>)) <span class="sc">*</span> (x <span class="sc">&gt;</span> <span class="dv">0</span>) <span class="sc">*</span> (x <span class="sc">&lt;</span> <span class="dv">1</span>)</span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>u <span class="ot">&lt;-</span> <span class="fu">runif</span>(m)</span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="sc">-</span> <span class="fu">log</span>(<span class="dv">1</span> <span class="sc">-</span> u <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> <span class="fu">exp</span>(<span class="sc">-</span><span class="dv">1</span>)))</span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a>fg <span class="ot">&lt;-</span> <span class="fu">g</span>(x) <span class="sc">/</span> (<span class="fu">exp</span>(<span class="sc">-</span>x) <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">-</span> <span class="fu">exp</span>(<span class="sc">-</span><span class="dv">1</span>)))</span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a>theta.hat <span class="ot">&lt;-</span> <span class="fu">mean</span>(fg)</span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a>r <span class="ot">&lt;-</span> <span class="fu">mean</span>((fg<span class="sc">-</span>theta.hat)<span class="sc">^</span><span class="dv">2</span>)<span class="co">#the variance got by Importance Sampling</span></span>
<span id="cb37-10"><a href="#cb37-10" aria-hidden="true" tabindex="-1"></a>r</span></code></pre></div>
<pre><code>## [1] 0.009314415</code></pre>
<p>Thus,we found that the variance got by Stratified Importance Sampling
is much smaller than the variance got by Importance Sampling.</p>
</div>
</div>
</div>
<div id="a-22077-2022-10-09" class="section level1">
<h1>A-22077-2022-10-09</h1>
<div id="question-1-1" class="section level3">
<h3>Question 1</h3>
<p><span class="math inline">\(6.4 \quad\)</span> Suppose that <span class="math inline">\(X_1,...,X_n\)</span> are a random sample from a
lognormal distribution with unknown parameters.Construct a 95%
confidence interval for the parameter <span class="math inline">\(\mu\)</span>. Use a Monte Carlo method to obtain
an empirical estimate of the confidence level.</p>
</div>
<div id="answer-1-1" class="section level3">
<h3>Answer 1</h3>
<p>Let <span class="math inline">\(Y=log(X),Y \sim
N(\mu,\sigma^2)\)</span> thus X obey a lognormal distribution with
parameters <span class="math inline">\(\mu,\sigma^2\)</span>,</p>
<p>Let <span class="math inline">\(Y_i=log(X_i),i=1,...,n\)</span>,thus
<span class="math inline">\(Y_1,...,Y_n\)</span> are a random sample
with the same distribution of <span class="math inline">\(Y\)</span>.</p>
<p>Thus we can get a 95% confidence interval:<span class="math inline">\((\hat\mu-t_{n-1}(0.95)\hat\sigma/\sqrt{n},\hat\mu+t_{n-1}(0.95)\hat\sigma)/\sqrt{n})\)</span>.</p>
<p>Then,We can estimate the confidence level with the following
steps:</p>
<p>We set <span class="math inline">\(\mu=0,\sigma^2=1\)</span>,sample
size n=1000,Number of repeated experiments is m=1000,<span class="math inline">\(\alpha=0.05\)</span> for example:</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">22077</span>)</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>n<span class="ot">&lt;-</span><span class="dv">1000</span></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>alpha<span class="ot">&lt;-</span><span class="fl">0.05</span></span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>muhat<span class="ot">&lt;-</span><span class="fu">numeric</span>(<span class="dv">2</span>)</span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>Z<span class="ot">&lt;-</span><span class="fu">numeric</span>(<span class="dv">1000</span>)<span class="co">#the times of mu in the confidence interval</span></span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">1000</span>){</span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a>  x<span class="ot">&lt;-</span><span class="fu">rlnorm</span>(n)</span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a>  muhat[<span class="dv">1</span>]<span class="ot">&lt;-</span><span class="fu">mean</span>(<span class="fu">log</span>(x))<span class="sc">-</span><span class="fu">sqrt</span>(<span class="fu">var</span>(<span class="fu">log</span>(x)))<span class="sc">*</span><span class="fu">qt</span>(<span class="dv">1</span><span class="sc">-</span>alpha<span class="sc">/</span><span class="dv">2</span>,<span class="at">df=</span>n<span class="dv">-1</span>)<span class="sc">/</span><span class="fu">sqrt</span>(n)</span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a>  muhat[<span class="dv">2</span>]<span class="ot">&lt;-</span><span class="fu">mean</span>(<span class="fu">log</span>(x))<span class="sc">+</span><span class="fu">sqrt</span>(<span class="fu">var</span>(<span class="fu">log</span>(x)))<span class="sc">*</span><span class="fu">qt</span>(<span class="dv">1</span><span class="sc">-</span>alpha<span class="sc">/</span><span class="dv">2</span>,<span class="at">df=</span>n<span class="dv">-1</span>)<span class="sc">/</span><span class="fu">sqrt</span>(n)</span>
<span id="cb39-10"><a href="#cb39-10" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(muhat[<span class="dv">1</span>]<span class="sc">&lt;</span><span class="dv">0</span> <span class="sc">&amp;&amp;</span> muhat[<span class="dv">2</span>]<span class="sc">&gt;</span><span class="dv">0</span>){</span>
<span id="cb39-11"><a href="#cb39-11" aria-hidden="true" tabindex="-1"></a>    Z[i]<span class="ot">=</span><span class="dv">1</span></span>
<span id="cb39-12"><a href="#cb39-12" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb39-13"><a href="#cb39-13" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb39-14"><a href="#cb39-14" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(Z)</span></code></pre></div>
<pre><code>## [1] 0.958</code></pre>
</div>
<div id="question-2" class="section level3">
<h3>Question 2</h3>
<p><span class="math inline">\(6.8 \quad\)</span> Refer to Example
6.16.Repeat the simulation,but also compute the F test of equal
variance,at significance level <span class="math inline">\(\hat\alpha=0.055\)</span>.Compute the power of the
Count Five test and F test for small,medium,and large sample
sizes,(Recall that F test is not applicable for non-normal
distributions.)</p>
</div>
<div id="answer-2-1" class="section level3">
<h3>Answer 2</h3>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>count5test <span class="ot">&lt;-</span> <span class="cf">function</span>(x,y){</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>  X <span class="ot">&lt;-</span> x<span class="sc">-</span><span class="fu">mean</span>(x)</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>  Y <span class="ot">&lt;-</span> y<span class="sc">-</span><span class="fu">mean</span>(y)</span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>  outx <span class="ot">&lt;-</span> (<span class="fu">sum</span>(X<span class="sc">&gt;</span><span class="fu">max</span>(Y))<span class="sc">+</span> <span class="fu">sum</span>(X<span class="sc">&lt;</span><span class="fu">min</span>(Y)))</span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>  outy <span class="ot">&lt;-</span> (<span class="fu">sum</span>(Y<span class="sc">&gt;</span><span class="fu">max</span>(X))<span class="sc">+</span> <span class="fu">sum</span>(Y<span class="sc">&lt;</span><span class="fu">min</span>(X)))</span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">as.integer</span>(<span class="fu">max</span>(<span class="fu">c</span>(outx,outy))<span class="sc">&gt;</span><span class="dv">5</span>))</span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a>}<span class="co">#Count Five test</span></span></code></pre></div>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>alpha<span class="ot">&lt;-</span><span class="fl">0.055</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>Ftest <span class="ot">&lt;-</span> <span class="cf">function</span>(x,y,n){</span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>  varx<span class="ot">&lt;-</span><span class="fu">var</span>(x)</span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>  vary<span class="ot">&lt;-</span><span class="fu">var</span>(y)</span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">var</span>(x)<span class="sc">/</span><span class="fu">var</span>(y)<span class="sc">&gt;=</span><span class="fu">qf</span>(alpha<span class="sc">/</span><span class="dv">2</span>,n<span class="dv">-1</span>,n<span class="dv">-1</span>) <span class="sc">&amp;&amp;</span> <span class="fu">var</span>(x)<span class="sc">/</span><span class="fu">var</span>(y)<span class="sc">&lt;=</span><span class="fu">qf</span>(<span class="dv">1</span><span class="sc">-</span>alpha<span class="sc">/</span><span class="dv">2</span>,n<span class="dv">-1</span>,n<span class="dv">-1</span>)){</span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="dv">0</span>)</span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a>  <span class="cf">else</span> <span class="fu">return</span>(<span class="dv">1</span>)</span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a>}<span class="co"># F test with alpha=0.055 and n1=n2=n</span></span></code></pre></div>
<p>We use <span class="math inline">\(N(\mu_1=0,\sigma_1^2=1)\)</span>
and <span class="math inline">\(N(\mu_1=0,\sigma_2^2=1.5^2)\)</span> for
example.</p>
<p>When <span class="math inline">\(n_1=n_2=20\)</span>:</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">22077</span>)</span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>m<span class="ot">&lt;-</span><span class="dv">10000</span></span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>n<span class="ot">&lt;-</span><span class="dv">20</span></span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>sigma1<span class="ot">&lt;-</span><span class="dv">1</span></span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>sigma2<span class="ot">&lt;-</span><span class="fl">1.5</span></span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a>powercount5<span class="ot">&lt;-</span><span class="fu">mean</span>(<span class="fu">replicate</span>(m,<span class="at">expr=</span>{</span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a>  x<span class="ot">&lt;-</span><span class="fu">rnorm</span>(n,<span class="dv">0</span>,sigma1)</span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a>  y<span class="ot">&lt;-</span><span class="fu">rnorm</span>(n,<span class="dv">0</span>,sigma2)</span>
<span id="cb43-9"><a href="#cb43-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count5test</span>(x,y)</span>
<span id="cb43-10"><a href="#cb43-10" aria-hidden="true" tabindex="-1"></a>}))</span>
<span id="cb43-11"><a href="#cb43-11" aria-hidden="true" tabindex="-1"></a><span class="co"># the power of Count Five test</span></span>
<span id="cb43-12"><a href="#cb43-12" aria-hidden="true" tabindex="-1"></a>powerF<span class="ot">&lt;-</span><span class="fu">mean</span>(<span class="fu">replicate</span>(m,<span class="at">expr=</span>{</span>
<span id="cb43-13"><a href="#cb43-13" aria-hidden="true" tabindex="-1"></a>  x<span class="ot">&lt;-</span><span class="fu">rnorm</span>(n,<span class="dv">0</span>,sigma1)</span>
<span id="cb43-14"><a href="#cb43-14" aria-hidden="true" tabindex="-1"></a>  y<span class="ot">&lt;-</span><span class="fu">rnorm</span>(n,<span class="dv">0</span>,sigma2)</span>
<span id="cb43-15"><a href="#cb43-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">Ftest</span>(x,y,n)</span>
<span id="cb43-16"><a href="#cb43-16" aria-hidden="true" tabindex="-1"></a>}))</span>
<span id="cb43-17"><a href="#cb43-17" aria-hidden="true" tabindex="-1"></a><span class="co"># the power of F test</span></span>
<span id="cb43-18"><a href="#cb43-18" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(powercount5)</span></code></pre></div>
<pre><code>## [1] 0.3138</code></pre>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(powerF)</span></code></pre></div>
<pre><code>## [1] 0.4195</code></pre>
<p>When <span class="math inline">\(n_1=n_2=100\)</span>:</p>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">22077</span>)</span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>m<span class="ot">&lt;-</span><span class="dv">10000</span></span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>n<span class="ot">&lt;-</span><span class="dv">100</span></span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a>sigma1<span class="ot">&lt;-</span><span class="dv">1</span></span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a>sigma2<span class="ot">&lt;-</span><span class="fl">1.5</span></span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a>powercount5<span class="ot">&lt;-</span><span class="fu">mean</span>(<span class="fu">replicate</span>(m,<span class="at">expr=</span>{</span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a>  x<span class="ot">&lt;-</span><span class="fu">rnorm</span>(n,<span class="dv">0</span>,sigma1)</span>
<span id="cb47-8"><a href="#cb47-8" aria-hidden="true" tabindex="-1"></a>  y<span class="ot">&lt;-</span><span class="fu">rnorm</span>(n,<span class="dv">0</span>,sigma2)</span>
<span id="cb47-9"><a href="#cb47-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count5test</span>(x,y)</span>
<span id="cb47-10"><a href="#cb47-10" aria-hidden="true" tabindex="-1"></a>}))</span>
<span id="cb47-11"><a href="#cb47-11" aria-hidden="true" tabindex="-1"></a><span class="co"># the power of Count Five test</span></span>
<span id="cb47-12"><a href="#cb47-12" aria-hidden="true" tabindex="-1"></a>powerF<span class="ot">&lt;-</span><span class="fu">mean</span>(<span class="fu">replicate</span>(m,<span class="at">expr=</span>{</span>
<span id="cb47-13"><a href="#cb47-13" aria-hidden="true" tabindex="-1"></a>  x<span class="ot">&lt;-</span><span class="fu">rnorm</span>(n,<span class="dv">0</span>,sigma1)</span>
<span id="cb47-14"><a href="#cb47-14" aria-hidden="true" tabindex="-1"></a>  y<span class="ot">&lt;-</span><span class="fu">rnorm</span>(n,<span class="dv">0</span>,sigma2)</span>
<span id="cb47-15"><a href="#cb47-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">Ftest</span>(x,y,n)</span>
<span id="cb47-16"><a href="#cb47-16" aria-hidden="true" tabindex="-1"></a>}))</span>
<span id="cb47-17"><a href="#cb47-17" aria-hidden="true" tabindex="-1"></a><span class="co"># the power of F test</span></span>
<span id="cb47-18"><a href="#cb47-18" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(powercount5)</span></code></pre></div>
<pre><code>## [1] 0.8493</code></pre>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(powerF)</span></code></pre></div>
<pre><code>## [1] 0.9823</code></pre>
<p>When <span class="math inline">\(n_1=n_2=1000\)</span>:</p>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">22077</span>)</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>m<span class="ot">&lt;-</span><span class="dv">10000</span></span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>n<span class="ot">&lt;-</span><span class="dv">1000</span></span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a>sigma1<span class="ot">&lt;-</span><span class="dv">1</span></span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a>sigma2<span class="ot">&lt;-</span><span class="fl">1.5</span></span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a>powercount5<span class="ot">&lt;-</span><span class="fu">mean</span>(<span class="fu">replicate</span>(m,<span class="at">expr=</span>{</span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a>  x<span class="ot">&lt;-</span><span class="fu">rnorm</span>(n,<span class="dv">0</span>,sigma1)</span>
<span id="cb51-8"><a href="#cb51-8" aria-hidden="true" tabindex="-1"></a>  y<span class="ot">&lt;-</span><span class="fu">rnorm</span>(n,<span class="dv">0</span>,sigma2)</span>
<span id="cb51-9"><a href="#cb51-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count5test</span>(x,y)</span>
<span id="cb51-10"><a href="#cb51-10" aria-hidden="true" tabindex="-1"></a>}))</span>
<span id="cb51-11"><a href="#cb51-11" aria-hidden="true" tabindex="-1"></a><span class="co"># the power of Count Five test</span></span>
<span id="cb51-12"><a href="#cb51-12" aria-hidden="true" tabindex="-1"></a>powerF<span class="ot">&lt;-</span><span class="fu">mean</span>(<span class="fu">replicate</span>(m,<span class="at">expr=</span>{</span>
<span id="cb51-13"><a href="#cb51-13" aria-hidden="true" tabindex="-1"></a>  x<span class="ot">&lt;-</span><span class="fu">rnorm</span>(n,<span class="dv">0</span>,sigma1)</span>
<span id="cb51-14"><a href="#cb51-14" aria-hidden="true" tabindex="-1"></a>  y<span class="ot">&lt;-</span><span class="fu">rnorm</span>(n,<span class="dv">0</span>,sigma2)</span>
<span id="cb51-15"><a href="#cb51-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">Ftest</span>(x,y,n)</span>
<span id="cb51-16"><a href="#cb51-16" aria-hidden="true" tabindex="-1"></a>}))</span>
<span id="cb51-17"><a href="#cb51-17" aria-hidden="true" tabindex="-1"></a><span class="co"># the power of F test</span></span>
<span id="cb51-18"><a href="#cb51-18" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(powercount5)</span></code></pre></div>
<pre><code>## [1] 0.9978</code></pre>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(powerF)</span></code></pre></div>
<pre><code>## [1] 1</code></pre>
<p>We can see ：</p>
<p>F test always has bigger power than Count Five test;</p>
<p>both of their powers are getting to 1 with the growing of n;</p>
<p>their powers are getting closer with the growing of n.</p>
</div>
<div id="question-3" class="section level3">
<h3>Question 3</h3>
<p>If we obtain the powers for two methods under a particular simulation
setting with 10000 experiments;say, 0.651 for one method and 0.676 for
another method. Can we say the powers are different at 0.05 level?</p>
<p>• What is the corresponding hypothesis test problem?</p>
<p>• Which test can we use? Z-test, two-sample t-test, paired-t test or
McNemar test? Why?</p>
<p>• Please provide the least necessary information for hypothesis
testing.</p>
</div>
<div id="answer-3" class="section level3">
<h3>Answer 3</h3>
<p>• The corresponding hypothesis test problem should be : <span class="math inline">\(H_0:power_1=power_2\)</span> <span class="math inline">\(H_1:power_1\neq power_2\)</span></p>
<p>• Since Z-test is only applicable to the situation of normal
distribution with known variance,thus we can not use Z-test;we should
use paired-t test or McNemar test because the data is paired.</p>
<p>• We need the powers of two different methods in 10000 experiments
and the mean and variance of their difference.</p>
</div>
</div>
<div id="a-22077-2022-10-14" class="section level1">
<h1>A-22077-2022-10-14</h1>
<div id="section" class="section level2">
<h2>7.4</h2>
<p>Refer to the air-conditioning data set <span class="math inline">\(aircondit\)</span> provided in the boot pack- age.
The 12 observations are the times in hours between failures of air-
conditioning equipment [63, Example 1.1]: 3, 5, 7, 18, 43, 85, 91, 98,
100, 130, 230, 487. Assume that the times between failures follow an
exponential model <span class="math inline">\(Exp(λ)\)</span>. Obtain
the <span class="math inline">\(MLE\)</span> of the hazard rate <span class="math inline">\(λ\)</span> and use bootstrap to estimate the bias
and standard error of the estimate.</p>
STEP1 Use the samples to get the MLE of <span class="math inline">\(\lambda\)</span>.
<p>STEP2 Use bootstrap to estimate the bias and standard error of the
estimate.</p>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">7</span>, <span class="dv">18</span>, <span class="dv">43</span>, <span class="dv">85</span>, <span class="dv">91</span>, <span class="dv">98</span>, <span class="dv">100</span>, <span class="dv">130</span>, <span class="dv">230</span>, <span class="dv">487</span>)</span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">22077</span>)</span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>s <span class="ot">&lt;-</span> <span class="cf">function</span>(y,i){</span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mean</span>(y[i])</span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb55-6"><a href="#cb55-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(boot)</span>
<span id="cb55-7"><a href="#cb55-7" aria-hidden="true" tabindex="-1"></a>replicate <span class="ot">&lt;-</span> <span class="fu">boot</span>(<span class="at">data=</span>y,<span class="at">statistic=</span>s,<span class="at">R=</span><span class="fl">1e4</span>)</span>
<span id="cb55-8"><a href="#cb55-8" aria-hidden="true" tabindex="-1"></a><span class="co"># use bootstrap to estimate MLE</span></span>
<span id="cb55-9"><a href="#cb55-9" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">c</span>(<span class="at">theta=</span>replicate<span class="sc">$</span>t0,<span class="at">bias=</span><span class="fu">mean</span>(replicate<span class="sc">$</span>t)<span class="sc">-</span>replicate<span class="sc">$</span>t0,<span class="at">se=</span><span class="fu">sd</span>(replicate<span class="sc">$</span>t)),<span class="dv">4</span>)</span></code></pre></div>
<pre><code>##    theta     bias       se 
## 108.0833  -0.1727  37.4904</code></pre>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">boot.ci</span>(replicate,<span class="at">type=</span><span class="fu">c</span>(<span class="st">&quot;norm&quot;</span>,<span class="st">&quot;basic&quot;</span>,<span class="st">&quot;perc&quot;</span>,<span class="st">&quot;bca&quot;</span>)))</span></code></pre></div>
<pre><code>## BOOTSTRAP CONFIDENCE INTERVAL CALCULATIONS
## Based on 10000 bootstrap replicates
## 
## CALL : 
## boot.ci(boot.out = replicate, type = c(&quot;norm&quot;, &quot;basic&quot;, &quot;perc&quot;, 
##     &quot;bca&quot;))
## 
## Intervals : 
## Level      Normal              Basic         
## 95%   ( 34.8, 181.7 )   ( 26.5, 168.8 )  
## 
## Level     Percentile            BCa          
## 95%   ( 47.3, 189.7 )   ( 57.8, 226.0 )  
## Calculations and Intervals on Original Scale</code></pre>
<p>Standard normal method requires samples of normal distribution.In
some case,which is not accurate;percentile method is more accurate,and
BCa method is a improved version of percentile method.</p>
</div>
<div id="a" class="section level2">
<h2>7.A</h2>
<p>Conduct a Monte Carlo study to estimate the coverage probabilities of
the standard normal bootstrap confidence interval, the basic bootstrap
confidence interval, and the percentile confidence interval. Sample from
a normal pop- ulation and check the empirical coverage rates for the
sample mean. Find the proportion of times that the confidence intervals
miss on the left, and the porportion of times that the confidence
intervals miss on the right.</p>
<p>we use <span class="math inline">\(\mu=0\)</span>,<span class="math inline">\(\sigma=1\)</span> for example</p>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">20</span>;m<span class="ot">=</span><span class="dv">1000</span></span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>sum1 <span class="ot">&lt;-</span> <span class="fu">numeric</span>(m);sum2 <span class="ot">&lt;-</span> <span class="fu">numeric</span>(m);sum3 <span class="ot">&lt;-</span> <span class="fu">numeric</span>(m);sum4 <span class="ot">&lt;-</span> <span class="fu">numeric</span>(m);</span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">22091</span>)</span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a>r <span class="ot">&lt;-</span> <span class="cf">function</span>(x,i){</span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mean</span>(x[i])</span>
<span id="cb59-6"><a href="#cb59-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb59-7"><a href="#cb59-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(boot)</span>
<span id="cb59-8"><a href="#cb59-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m){</span>
<span id="cb59-9"><a href="#cb59-9" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span><span class="fu">rnorm</span>(n)</span>
<span id="cb59-10"><a href="#cb59-10" aria-hidden="true" tabindex="-1"></a>  obj <span class="ot">&lt;-</span> <span class="fu">boot</span>(<span class="at">data=</span>x,<span class="at">statistic=</span>r,<span class="at">R=</span><span class="fl">1e4</span>)</span>
<span id="cb59-11"><a href="#cb59-11" aria-hidden="true" tabindex="-1"></a>  cl <span class="ot">&lt;-</span> <span class="fu">boot.ci</span>(obj,<span class="at">type=</span><span class="fu">c</span>(<span class="st">&quot;norm&quot;</span>,<span class="st">&quot;basic&quot;</span>,<span class="st">&quot;perc&quot;</span>,<span class="st">&quot;bca&quot;</span>)) <span class="co"># Compute 95% bootstrap confidence intervals</span></span>
<span id="cb59-12"><a href="#cb59-12" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(cl<span class="sc">$</span>norm[<span class="dv">2</span>]<span class="sc">&lt;</span><span class="dv">0</span> <span class="sc">&amp;&amp;</span> cl<span class="sc">$</span>norm[<span class="dv">3</span>]<span class="sc">&gt;</span><span class="dv">0</span>){</span>
<span id="cb59-13"><a href="#cb59-13" aria-hidden="true" tabindex="-1"></a>    sum1[i] <span class="ot">&lt;-</span><span class="dv">1</span></span>
<span id="cb59-14"><a href="#cb59-14" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb59-15"><a href="#cb59-15" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(cl<span class="sc">$</span>basic[<span class="dv">4</span>]<span class="sc">&lt;</span><span class="dv">0</span> <span class="sc">&amp;&amp;</span> cl<span class="sc">$</span>basic[<span class="dv">5</span>]<span class="sc">&gt;</span><span class="dv">0</span>){</span>
<span id="cb59-16"><a href="#cb59-16" aria-hidden="true" tabindex="-1"></a>    sum2[i] <span class="ot">&lt;-</span><span class="dv">1</span></span>
<span id="cb59-17"><a href="#cb59-17" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb59-18"><a href="#cb59-18" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(cl<span class="sc">$</span>perc[<span class="dv">4</span>]<span class="sc">&lt;</span><span class="dv">0</span> <span class="sc">&amp;&amp;</span> cl<span class="sc">$</span>perc[<span class="dv">5</span>]<span class="sc">&gt;</span><span class="dv">0</span>){</span>
<span id="cb59-19"><a href="#cb59-19" aria-hidden="true" tabindex="-1"></a>    sum3[i] <span class="ot">&lt;-</span><span class="dv">1</span></span>
<span id="cb59-20"><a href="#cb59-20" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb59-21"><a href="#cb59-21" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(cl<span class="sc">$</span>bca[<span class="dv">4</span>]<span class="sc">&lt;</span><span class="dv">0</span> <span class="sc">&amp;&amp;</span> cl<span class="sc">$</span>bca[<span class="dv">5</span>]<span class="sc">&gt;</span><span class="dv">0</span>){</span>
<span id="cb59-22"><a href="#cb59-22" aria-hidden="true" tabindex="-1"></a>    sum4[i] <span class="ot">&lt;-</span><span class="dv">1</span></span>
<span id="cb59-23"><a href="#cb59-23" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb59-24"><a href="#cb59-24" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb59-25"><a href="#cb59-25" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">c</span>(<span class="at">norm=</span><span class="fu">mean</span>(sum1),<span class="at">basic=</span><span class="fu">mean</span>(sum2),<span class="at">perc=</span><span class="fu">mean</span>(sum3),<span class="at">bca=</span><span class="fu">mean</span>(sum4)),<span class="dv">3</span>)</span></code></pre></div>
<pre><code>##  norm basic  perc   bca 
## 0.931 0.931 0.929 0.930</code></pre>
</div>
</div>
<div id="a-22077-2022-10-21" class="section level1">
<h1>A-22077-2022-10-21</h1>
<div id="question" class="section level2">
<h2>Question</h2>
<ol style="list-style-type: decimal">
<li><p>Exercises 7.8 (Page 213, Statistical Computing with R). <a href="#question1ans">Jump to the Answer</a></p></li>
<li><p>Exercises 7.11 (Page 213, Statistical Computing with R). <a href="#question2ans">Jump to the Answer</a></p></li>
<li><p>Exercises 8.2 (Page 242, Statistical Computing with R). <a href="#question3ans">Jump to the Answer</a></p></li>
</ol>
</div>
<div id="answer-4" class="section level2">
<h2>Answer</h2>
<div id="question1ans" class="section level3">
<h3>Exercise 7.8</h3>
<p><strong>Problem.</strong> Refer to Exercise 7.7. Obtain the jackknife
estimates of bias and standard error of <span class="math inline">\(\hat{\theta}\)</span>.</p>
<p><strong>Solution.</strong> First, we write a function to calculate
<span class="math inline">\(\hat{\theta}\)</span>. Then we can use the
jackknife.</p>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>rm<span class="ot">=</span><span class="fu">list</span>(<span class="fu">c</span>())</span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a><span class="co">#write the function</span></span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a>pca<span class="ot">=</span><span class="cf">function</span>(x,i){</span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a>  val<span class="ot">=</span><span class="fu">eigen</span>(<span class="fu">cov</span>(x[i,]))<span class="sc">$</span>values</span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(val[<span class="dv">1</span>]<span class="sc">/</span><span class="fu">sum</span>(val))</span>
<span id="cb61-6"><a href="#cb61-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb61-7"><a href="#cb61-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-8"><a href="#cb61-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(bootstrap)</span>
<span id="cb61-9"><a href="#cb61-9" aria-hidden="true" tabindex="-1"></a>n<span class="ot">=</span><span class="fu">nrow</span>(scor)</span>
<span id="cb61-10"><a href="#cb61-10" aria-hidden="true" tabindex="-1"></a>theta.hat <span class="ot">&lt;-</span> <span class="fu">pca</span>(scor,<span class="dv">1</span><span class="sc">:</span>n)</span>
<span id="cb61-11"><a href="#cb61-11" aria-hidden="true" tabindex="-1"></a>theta.jack <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n)</span>
<span id="cb61-12"><a href="#cb61-12" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n){</span>
<span id="cb61-13"><a href="#cb61-13" aria-hidden="true" tabindex="-1"></a>theta.jack[i] <span class="ot">&lt;-</span> <span class="fu">pca</span>(scor,(<span class="dv">1</span><span class="sc">:</span>n)[<span class="sc">-</span>i])</span>
<span id="cb61-14"><a href="#cb61-14" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb61-15"><a href="#cb61-15" aria-hidden="true" tabindex="-1"></a>bias.jack <span class="ot">&lt;-</span> (n<span class="dv">-1</span>)<span class="sc">*</span>(<span class="fu">mean</span>(theta.jack)<span class="sc">-</span>theta.hat)</span>
<span id="cb61-16"><a href="#cb61-16" aria-hidden="true" tabindex="-1"></a>se.jack <span class="ot">&lt;-</span> <span class="fu">sqrt</span>((n<span class="dv">-1</span>)<span class="sc">*</span><span class="fu">mean</span>((theta.jack<span class="sc">-</span>theta.hat)<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb61-17"><a href="#cb61-17" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">c</span>(<span class="at">original=</span>theta.hat,<span class="at">bias.jack=</span>bias.jack,</span>
<span id="cb61-18"><a href="#cb61-18" aria-hidden="true" tabindex="-1"></a><span class="at">se.jack=</span>se.jack),<span class="dv">3</span>)</span></code></pre></div>
<pre><code>##  original bias.jack   se.jack 
##     0.619     0.001     0.050</code></pre>
<p><a href="#question">Back to the Question</a></p>
</div>
<div id="question2ans" class="section level3">
<h3>Exercise 7.11</h3>
<p><strong>Problem.</strong> In Example 7.18, leave-one-out ( <span class="math inline">\(n\)</span>-fold) cross validation was used to
select the best fitting model. Use leave-two-out cross validation to
compare the models.</p>
<p><strong>Solution.</strong></p>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>rm<span class="ot">=</span><span class="fu">list</span>(<span class="fu">c</span>())</span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(DAAG)</span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a><span class="fu">attach</span>(ironslag)</span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a>n<span class="ot">=</span><span class="fu">length</span>(magnetic)</span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a>e1<span class="ot">=</span>e2<span class="ot">=</span>e3<span class="ot">=</span>e4<span class="ot">=</span><span class="fu">c</span>()</span>
<span id="cb63-6"><a href="#cb63-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-7"><a href="#cb63-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (k <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>(n<span class="dv">-1</span>)) {</span>
<span id="cb63-8"><a href="#cb63-8" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (l <span class="cf">in</span> (k<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>n) {</span>
<span id="cb63-9"><a href="#cb63-9" aria-hidden="true" tabindex="-1"></a>    y<span class="ot">=</span>magnetic[<span class="sc">-</span><span class="fu">c</span>(k,l)]</span>
<span id="cb63-10"><a href="#cb63-10" aria-hidden="true" tabindex="-1"></a>    x<span class="ot">=</span>chemical[<span class="sc">-</span><span class="fu">c</span>(k,l)]</span>
<span id="cb63-11"><a href="#cb63-11" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb63-12"><a href="#cb63-12" aria-hidden="true" tabindex="-1"></a>    J1<span class="ot">=</span><span class="fu">lm</span>(y<span class="sc">~</span>x)</span>
<span id="cb63-13"><a href="#cb63-13" aria-hidden="true" tabindex="-1"></a>    yhat11<span class="ot">=</span>J1<span class="sc">$</span>coef[<span class="dv">1</span>]<span class="sc">+</span>J1<span class="sc">$</span>coef[<span class="dv">2</span>]<span class="sc">*</span>chemical[k]</span>
<span id="cb63-14"><a href="#cb63-14" aria-hidden="true" tabindex="-1"></a>    yhat12<span class="ot">=</span>J1<span class="sc">$</span>coef[<span class="dv">1</span>]<span class="sc">+</span>J1<span class="sc">$</span>coef[<span class="dv">2</span>]<span class="sc">*</span>chemical[l]</span>
<span id="cb63-15"><a href="#cb63-15" aria-hidden="true" tabindex="-1"></a>    e1<span class="ot">=</span><span class="fu">c</span>(e1,magnetic[k]<span class="sc">-</span>yhat11,magnetic[l]<span class="sc">-</span>yhat12)</span>
<span id="cb63-16"><a href="#cb63-16" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb63-17"><a href="#cb63-17" aria-hidden="true" tabindex="-1"></a>    J2<span class="ot">=</span><span class="fu">lm</span>(y<span class="sc">~</span>x<span class="sc">+</span><span class="fu">I</span>(x<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb63-18"><a href="#cb63-18" aria-hidden="true" tabindex="-1"></a>    yhat21<span class="ot">=</span>J2<span class="sc">$</span>coef[<span class="dv">1</span>]<span class="sc">+</span>J2<span class="sc">$</span>coef[<span class="dv">2</span>]<span class="sc">*</span>chemical[k]<span class="sc">+</span>J2<span class="sc">$</span>coef[<span class="dv">3</span>]<span class="sc">*</span>chemical[k]<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb63-19"><a href="#cb63-19" aria-hidden="true" tabindex="-1"></a>    yhat22<span class="ot">=</span>J2<span class="sc">$</span>coef[<span class="dv">1</span>]<span class="sc">+</span>J2<span class="sc">$</span>coef[<span class="dv">2</span>]<span class="sc">*</span>chemical[l]<span class="sc">+</span>J2<span class="sc">$</span>coef[<span class="dv">3</span>]<span class="sc">*</span>chemical[l]<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb63-20"><a href="#cb63-20" aria-hidden="true" tabindex="-1"></a>    e2<span class="ot">=</span><span class="fu">c</span>(e2,magnetic[k]<span class="sc">-</span>yhat21,magnetic[l]<span class="sc">-</span>yhat22)</span>
<span id="cb63-21"><a href="#cb63-21" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb63-22"><a href="#cb63-22" aria-hidden="true" tabindex="-1"></a>    J3<span class="ot">=</span><span class="fu">lm</span>(<span class="fu">log</span>(y)<span class="sc">~</span>x)</span>
<span id="cb63-23"><a href="#cb63-23" aria-hidden="true" tabindex="-1"></a>    yhat31<span class="ot">=</span><span class="fu">exp</span>(J3<span class="sc">$</span>coef[<span class="dv">1</span>]<span class="sc">+</span>J3<span class="sc">$</span>coef[<span class="dv">2</span>]<span class="sc">*</span>chemical[k])</span>
<span id="cb63-24"><a href="#cb63-24" aria-hidden="true" tabindex="-1"></a>    yhat32<span class="ot">=</span><span class="fu">exp</span>(J3<span class="sc">$</span>coef[<span class="dv">1</span>]<span class="sc">+</span>J3<span class="sc">$</span>coef[<span class="dv">2</span>]<span class="sc">*</span>chemical[l])</span>
<span id="cb63-25"><a href="#cb63-25" aria-hidden="true" tabindex="-1"></a>    e3<span class="ot">=</span><span class="fu">c</span>(e3,magnetic[k]<span class="sc">-</span>yhat31,magnetic[l]<span class="sc">-</span>yhat32)</span>
<span id="cb63-26"><a href="#cb63-26" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb63-27"><a href="#cb63-27" aria-hidden="true" tabindex="-1"></a>    J4<span class="ot">=</span><span class="fu">lm</span>(<span class="fu">log</span>(y)<span class="sc">~</span><span class="fu">log</span>(x))</span>
<span id="cb63-28"><a href="#cb63-28" aria-hidden="true" tabindex="-1"></a>    yhat41<span class="ot">=</span><span class="fu">exp</span>(J4<span class="sc">$</span>coef[<span class="dv">1</span>]<span class="sc">+</span>J4<span class="sc">$</span>coef[<span class="dv">2</span>]<span class="sc">*</span><span class="fu">log</span>(chemical[k]))</span>
<span id="cb63-29"><a href="#cb63-29" aria-hidden="true" tabindex="-1"></a>    yhat42<span class="ot">=</span><span class="fu">exp</span>(J4<span class="sc">$</span>coef[<span class="dv">1</span>]<span class="sc">+</span>J4<span class="sc">$</span>coef[<span class="dv">2</span>]<span class="sc">*</span><span class="fu">log</span>(chemical[l]))</span>
<span id="cb63-30"><a href="#cb63-30" aria-hidden="true" tabindex="-1"></a>    e4<span class="ot">=</span><span class="fu">c</span>(e4,magnetic[k]<span class="sc">-</span>yhat41,magnetic[l]<span class="sc">-</span>yhat42)</span>
<span id="cb63-31"><a href="#cb63-31" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb63-32"><a href="#cb63-32" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb63-33"><a href="#cb63-33" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(<span class="fu">mean</span>(e1<span class="sc">^</span><span class="dv">2</span>),<span class="fu">mean</span>(e2<span class="sc">^</span><span class="dv">2</span>),<span class="fu">mean</span>(e3<span class="sc">^</span><span class="dv">2</span>),<span class="fu">mean</span>(e4<span class="sc">^</span><span class="dv">2</span>))</span></code></pre></div>
<pre><code>## [1] 19.57227 17.87018 18.45491 20.46718</code></pre>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="fu">detach</span>(ironslag)</span></code></pre></div>
<p>Comparing the results, we know the model 2 fits the data most.</p>
<p><a href="#question">Back to the Question</a></p>
</div>
<div id="question3ans" class="section level3">
<h3>Exercise 8.2</h3>
<p><strong>Problem.</strong> Implement the bivariate Spearman rank
correlation test for independence [255] as a permutation test. The
Spearman rank correlation test statistic can be obtained from function
cor with method = “spearman”. Compare the achieved significance level of
the permutation test with the <span class="math inline">\(p\)</span>-value reported by cor. test on the same
samples.</p>
<p><strong>Solution.</strong> We generate samples from the standard
normal distribution.</p>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a>rm<span class="ot">=</span><span class="fu">list</span>(<span class="fu">c</span>())</span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">11111</span>)</span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a>x<span class="ot">=</span><span class="fu">rnorm</span>(<span class="dv">12</span>)</span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a>y<span class="ot">=</span><span class="fu">rnorm</span>(<span class="dv">12</span>)</span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-6"><a href="#cb66-6" aria-hidden="true" tabindex="-1"></a>R<span class="ot">=</span><span class="dv">999</span></span>
<span id="cb66-7"><a href="#cb66-7" aria-hidden="true" tabindex="-1"></a>z<span class="ot">=</span><span class="fu">c</span>(x,y)</span>
<span id="cb66-8"><a href="#cb66-8" aria-hidden="true" tabindex="-1"></a>K<span class="ot">=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">24</span></span>
<span id="cb66-9"><a href="#cb66-9" aria-hidden="true" tabindex="-1"></a>D<span class="ot">=</span><span class="fu">numeric</span>(R)</span>
<span id="cb66-10"><a href="#cb66-10" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">warn=</span><span class="sc">-</span><span class="dv">1</span>)</span>
<span id="cb66-11"><a href="#cb66-11" aria-hidden="true" tabindex="-1"></a>D0<span class="ot">=</span><span class="fu">cor</span>(x,y,<span class="at">method =</span> <span class="st">&quot;spearman&quot;</span>)</span>
<span id="cb66-12"><a href="#cb66-12" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>R){</span>
<span id="cb66-13"><a href="#cb66-13" aria-hidden="true" tabindex="-1"></a>  k<span class="ot">=</span><span class="fu">sample</span>(K,<span class="at">size=</span><span class="dv">12</span>,<span class="at">replace =</span> <span class="cn">FALSE</span>)</span>
<span id="cb66-14"><a href="#cb66-14" aria-hidden="true" tabindex="-1"></a>  x1<span class="ot">=</span>z[k]</span>
<span id="cb66-15"><a href="#cb66-15" aria-hidden="true" tabindex="-1"></a>  y1<span class="ot">=</span>z[<span class="sc">-</span>k]</span>
<span id="cb66-16"><a href="#cb66-16" aria-hidden="true" tabindex="-1"></a>  D[i]<span class="ot">=</span><span class="fu">cor</span>(x1,y1,<span class="at">method =</span> <span class="st">&quot;spearman&quot;</span>)</span>
<span id="cb66-17"><a href="#cb66-17" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb66-18"><a href="#cb66-18" aria-hidden="true" tabindex="-1"></a>p<span class="ot">=</span><span class="fu">mean</span>(<span class="fu">c</span>(D0,D)<span class="sc">&gt;=</span>D0)</span>
<span id="cb66-19"><a href="#cb66-19" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">warn=</span><span class="dv">0</span>)</span>
<span id="cb66-20"><a href="#cb66-20" aria-hidden="true" tabindex="-1"></a>p</span></code></pre></div>
<pre><code>## [1] 0.223</code></pre>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor.test</span>(x,y)</span></code></pre></div>
<pre><code>## 
##  Pearson&#39;s product-moment correlation
## 
## data:  x and y
## t = 1.3286, df = 10, p-value = 0.2135
## alternative hypothesis: true correlation is not equal to 0
## 95 percent confidence interval:
##  -0.2398732  0.7864293
## sample estimates:
##       cor 
## 0.3873528</code></pre>
<p>We can learn that the two p-values are not really different, and they
both accept the null hypothesis.</p>
<p><a href="#question">Back to the Question</a></p>
<hr />
</div>
</div>
</div>
<div id="a-22077-2022-10-28" class="section level1">
<h1>A-22077-2022-10-28</h1>
<div id="question-1-2" class="section level2">
<h2>Question 1</h2>
<p>$ 9.4$ Implement a random walk Metropolis sampler for generating the
standard Laplace distribution (see Exercise 3.2). For the increment,
simulate from a normal distribution. Compare the chains generated when
different variances are used for the proposal distributon. Also, compute
the acceptance rates of each chain.And use the Gelman-Rubin method to
monitor convergence of the chain, and run the chain until it converges
approximately to the target distribution according to ˆR &lt; 1.2.</p>
</div>
<div id="answer-1-2" class="section level2">
<h2>Answer 1</h2>
<p>use proposal distribution <span class="math inline">\(N(X_t,\sigma^2)\)</span> to generate with four
different sigma 0.05, 0.5, 2, 16.</p>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">22077</span>)</span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a><span class="co"># use the function below to calculate the density of  Laplace distribution</span></span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a>f <span class="ot">&lt;-</span> <span class="cf">function</span>(x){</span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">exp</span>(<span class="sc">-</span><span class="fu">abs</span>(x))<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb70-5"><a href="#cb70-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb70-6"><a href="#cb70-6" aria-hidden="true" tabindex="-1"></a><span class="co"># use the function below to generate chain with given parameters:sigma,n,X_0,N</span></span>
<span id="cb70-7"><a href="#cb70-7" aria-hidden="true" tabindex="-1"></a>mh <span class="ot">&lt;-</span> <span class="cf">function</span>(sigma,N,x0){</span>
<span id="cb70-8"><a href="#cb70-8" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">numeric</span>(N)</span>
<span id="cb70-9"><a href="#cb70-9" aria-hidden="true" tabindex="-1"></a>  x[<span class="dv">1</span>] <span class="ot">&lt;-</span> x0</span>
<span id="cb70-10"><a href="#cb70-10" aria-hidden="true" tabindex="-1"></a>  u <span class="ot">&lt;-</span> <span class="fu">runif</span>(N)</span>
<span id="cb70-11"><a href="#cb70-11" aria-hidden="true" tabindex="-1"></a>  k <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb70-12"><a href="#cb70-12" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>N){</span>
<span id="cb70-13"><a href="#cb70-13" aria-hidden="true" tabindex="-1"></a>    xt <span class="ot">&lt;-</span> x[i<span class="dv">-1</span>]</span>
<span id="cb70-14"><a href="#cb70-14" aria-hidden="true" tabindex="-1"></a>    y <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>,xt,sigma)</span>
<span id="cb70-15"><a href="#cb70-15" aria-hidden="true" tabindex="-1"></a>    num <span class="ot">&lt;-</span> <span class="fu">f</span>(y)<span class="sc">*</span><span class="fu">dnorm</span>(xt,y,sigma)</span>
<span id="cb70-16"><a href="#cb70-16" aria-hidden="true" tabindex="-1"></a>    den <span class="ot">&lt;-</span> <span class="fu">f</span>(xt)<span class="sc">*</span><span class="fu">dnorm</span>(y,xt,sigma)</span>
<span id="cb70-17"><a href="#cb70-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(u[i] <span class="sc">&lt;=</span> num<span class="sc">/</span>den) x[i] <span class="ot">&lt;-</span> y <span class="cf">else</span>{</span>
<span id="cb70-18"><a href="#cb70-18" aria-hidden="true" tabindex="-1"></a>      x[i] <span class="ot">&lt;-</span> xt </span>
<span id="cb70-19"><a href="#cb70-19" aria-hidden="true" tabindex="-1"></a>      k <span class="ot">&lt;-</span> k<span class="sc">+</span><span class="dv">1</span> <span class="co"># y is rejected</span></span>
<span id="cb70-20"><a href="#cb70-20" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb70-21"><a href="#cb70-21" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb70-22"><a href="#cb70-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">x=</span>x,<span class="at">k=</span>k))</span>
<span id="cb70-23"><a href="#cb70-23" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb70-24"><a href="#cb70-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-25"><a href="#cb70-25" aria-hidden="true" tabindex="-1"></a><span class="co"># generate chains with four differeint sigma</span></span>
<span id="cb70-26"><a href="#cb70-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-27"><a href="#cb70-27" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">15000</span></span>
<span id="cb70-28"><a href="#cb70-28" aria-hidden="true" tabindex="-1"></a>sigma <span class="ot">&lt;-</span> <span class="fu">c</span>(.<span class="dv">05</span>, .<span class="dv">5</span>, <span class="dv">2</span>, <span class="dv">16</span>)</span>
<span id="cb70-29"><a href="#cb70-29" aria-hidden="true" tabindex="-1"></a>x0 <span class="ot">&lt;-</span> <span class="dv">25</span></span>
<span id="cb70-30"><a href="#cb70-30" aria-hidden="true" tabindex="-1"></a>mh1 <span class="ot">&lt;-</span> <span class="fu">mh</span>(sigma[<span class="dv">1</span>],N,x0)</span>
<span id="cb70-31"><a href="#cb70-31" aria-hidden="true" tabindex="-1"></a>mh2 <span class="ot">&lt;-</span> <span class="fu">mh</span>(sigma[<span class="dv">2</span>],N,x0)</span>
<span id="cb70-32"><a href="#cb70-32" aria-hidden="true" tabindex="-1"></a>mh3 <span class="ot">&lt;-</span> <span class="fu">mh</span>(sigma[<span class="dv">3</span>],N,x0)</span>
<span id="cb70-33"><a href="#cb70-33" aria-hidden="true" tabindex="-1"></a>mh4 <span class="ot">&lt;-</span> <span class="fu">mh</span>(sigma[<span class="dv">4</span>],N,x0)</span>
<span id="cb70-34"><a href="#cb70-34" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate the acceptance rates</span></span>
<span id="cb70-35"><a href="#cb70-35" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">c</span>((N<span class="sc">-</span>mh1<span class="sc">$</span>k)<span class="sc">/</span>N,(N<span class="sc">-</span>mh2<span class="sc">$</span>k)<span class="sc">/</span>N,(N<span class="sc">-</span>mh3<span class="sc">$</span>k)<span class="sc">/</span>N,(N<span class="sc">-</span>mh4<span class="sc">$</span>k)<span class="sc">/</span>N))</span></code></pre></div>
<pre><code>## [1] 0.9821333 0.8248667 0.5334667 0.0998000</code></pre>
<p>we can see that the acceptance rates become smaller with the growing
of sigma</p>
<p>use the Gelman-Rubin method to monitor convergence of the chain,we
use sigma =0.5 for example</p>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a>Gelman.Rubin <span class="ot">&lt;-</span> <span class="cf">function</span>(psi){</span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># psi[i,j] is the statistic psi(X[i,1:j])</span></span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># for chain in i_th row of X</span></span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a>  pis <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(psi)</span>
<span id="cb72-5"><a href="#cb72-5" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">ncol</span>(psi)</span>
<span id="cb72-6"><a href="#cb72-6" aria-hidden="true" tabindex="-1"></a>  k <span class="ot">&lt;-</span> <span class="fu">nrow</span>(psi)</span>
<span id="cb72-7"><a href="#cb72-7" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb72-8"><a href="#cb72-8" aria-hidden="true" tabindex="-1"></a>  psi.means <span class="ot">&lt;-</span> <span class="fu">rowMeans</span>(psi)</span>
<span id="cb72-9"><a href="#cb72-9" aria-hidden="true" tabindex="-1"></a>  B <span class="ot">&lt;-</span> n<span class="sc">*</span><span class="fu">var</span>(psi.means)</span>
<span id="cb72-10"><a href="#cb72-10" aria-hidden="true" tabindex="-1"></a>  psi.w <span class="ot">&lt;-</span> <span class="fu">apply</span>(psi,<span class="dv">1</span>,<span class="st">&quot;var&quot;</span>)</span>
<span id="cb72-11"><a href="#cb72-11" aria-hidden="true" tabindex="-1"></a>  W <span class="ot">&lt;-</span> <span class="fu">mean</span>(psi.w)</span>
<span id="cb72-12"><a href="#cb72-12" aria-hidden="true" tabindex="-1"></a>  v.hat <span class="ot">&lt;-</span> W<span class="sc">*</span>(n<span class="dv">-1</span>)<span class="sc">/</span>n <span class="sc">+</span> (B<span class="sc">/</span>n)</span>
<span id="cb72-13"><a href="#cb72-13" aria-hidden="true" tabindex="-1"></a>  r.hat <span class="ot">&lt;-</span> v.hat <span class="sc">/</span> W            <span class="co"># G-R statistic</span></span>
<span id="cb72-14"><a href="#cb72-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(r.hat)</span>
<span id="cb72-15"><a href="#cb72-15" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb72-16"><a href="#cb72-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-17"><a href="#cb72-17" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="dv">4</span></span>
<span id="cb72-18"><a href="#cb72-18" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb72-19"><a href="#cb72-19" aria-hidden="true" tabindex="-1"></a>sigma <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb72-20"><a href="#cb72-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-21"><a href="#cb72-21" aria-hidden="true" tabindex="-1"></a><span class="co"># choose overdispersed initial values</span></span>
<span id="cb72-22"><a href="#cb72-22" aria-hidden="true" tabindex="-1"></a>x0 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">10</span>,<span class="sc">-</span><span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">10</span>)</span>
<span id="cb72-23"><a href="#cb72-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-24"><a href="#cb72-24" aria-hidden="true" tabindex="-1"></a><span class="co"># generate the chains</span></span>
<span id="cb72-25"><a href="#cb72-25" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>,<span class="at">nrow=</span>k,<span class="at">ncol=</span>N)</span>
<span id="cb72-26"><a href="#cb72-26" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k){</span>
<span id="cb72-27"><a href="#cb72-27" aria-hidden="true" tabindex="-1"></a>  X[i,] <span class="ot">&lt;-</span> <span class="fu">mh</span>(sigma,N,x0[i])<span class="sc">$</span>x</span>
<span id="cb72-28"><a href="#cb72-28" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb72-29"><a href="#cb72-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-30"><a href="#cb72-30" aria-hidden="true" tabindex="-1"></a><span class="co"># compute diagnostic statistics</span></span>
<span id="cb72-31"><a href="#cb72-31" aria-hidden="true" tabindex="-1"></a>psi <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">apply</span>(X,<span class="dv">1</span>,cumsum))</span>
<span id="cb72-32"><a href="#cb72-32" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(psi))</span>
<span id="cb72-33"><a href="#cb72-33" aria-hidden="true" tabindex="-1"></a>  psi[i,] <span class="ot">&lt;-</span> psi[i,]<span class="sc">/</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(psi))</span>
<span id="cb72-34"><a href="#cb72-34" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">Gelman.Rubin</span>(psi))</span></code></pre></div>
<pre><code>## [1] 1.179309</code></pre>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="co">#plot the sequence of R-hat statistics</span></span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a>rhat <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>,N)</span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(j <span class="cf">in</span> (b<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>N)</span>
<span id="cb74-4"><a href="#cb74-4" aria-hidden="true" tabindex="-1"></a>  rhat[j] <span class="ot">&lt;-</span> <span class="fu">Gelman.Rubin</span>(psi[,<span class="dv">1</span><span class="sc">:</span>j])</span>
<span id="cb74-5"><a href="#cb74-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rhat[(b<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>N],<span class="at">type=</span><span class="st">&quot;l&quot;</span>,<span class="at">xlab=</span><span class="st">&quot;&quot;</span>,<span class="at">ylab=</span><span class="st">&quot;R&quot;</span>)</span>
<span id="cb74-6"><a href="#cb74-6" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span><span class="fl">1.2</span>,<span class="at">lty=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>we can see when N=15000,the <span class="math inline">\(\hat
R\)</span> is smaller than 1.2, and when N is about 6000,the <span class="math inline">\(\hat R\)</span> is about 1.2,which means the chain
converges approximately to the target distribution</p>
</div>
<div id="queston-2" class="section level2">
<h2>Queston 2</h2>
<p>$ 9.7 $ Implement a Gibbs sampler to generate a bivariate normal
chain (Xt, Yt) with zero means, unit standard deviations, and
correlation 0.9. Plot the generated sample after discarding a suitable
burn-in sample. Fit a simple linear regression model Y = β0 + β1X to the
sample and check the residuals of the model for normality and constant
variance.And use the Gelman-Rubin method to monitor convergence of the
chain, and run the chain until it converges approximately to the target
distribution according to ˆR &lt; 1.2.</p>
</div>
<div id="answer-2-2" class="section level2">
<h2>Answer 2</h2>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="co"># initialize constants and parameters</span></span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">5000</span>          <span class="co"># length of chain</span></span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a>burn <span class="ot">&lt;-</span> <span class="dv">1000</span>       <span class="co"># burn-in length</span></span>
<span id="cb75-4"><a href="#cb75-4" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>,N,<span class="dv">2</span>) <span class="co"># the chain, a bivariate sample</span></span>
<span id="cb75-5"><a href="#cb75-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-6"><a href="#cb75-6" aria-hidden="true" tabindex="-1"></a>rho <span class="ot">&lt;-</span> <span class="fl">0.9</span>         <span class="co"># correlation</span></span>
<span id="cb75-7"><a href="#cb75-7" aria-hidden="true" tabindex="-1"></a>mu1 <span class="ot">&lt;-</span> mu2 <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb75-8"><a href="#cb75-8" aria-hidden="true" tabindex="-1"></a>sigma1 <span class="ot">&lt;-</span> sigma2 <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb75-9"><a href="#cb75-9" aria-hidden="true" tabindex="-1"></a>s1 <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="dv">1</span><span class="sc">-</span>rho<span class="sc">^</span><span class="dv">2</span>)<span class="sc">*</span>sigma1</span>
<span id="cb75-10"><a href="#cb75-10" aria-hidden="true" tabindex="-1"></a>s2 <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="dv">1</span><span class="sc">-</span>rho<span class="sc">^</span><span class="dv">2</span>)<span class="sc">*</span>sigma2</span>
<span id="cb75-11"><a href="#cb75-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-12"><a href="#cb75-12" aria-hidden="true" tabindex="-1"></a><span class="do">##### generate the chain #####</span></span>
<span id="cb75-13"><a href="#cb75-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-14"><a href="#cb75-14" aria-hidden="true" tabindex="-1"></a>X[<span class="dv">1</span>, ] <span class="ot">&lt;-</span> <span class="fu">c</span>(mu1,mu2)  <span class="co"># initialize</span></span>
<span id="cb75-15"><a href="#cb75-15" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>N){</span>
<span id="cb75-16"><a href="#cb75-16" aria-hidden="true" tabindex="-1"></a>  x2 <span class="ot">&lt;-</span> X[i<span class="dv">-1</span>,<span class="dv">2</span>]</span>
<span id="cb75-17"><a href="#cb75-17" aria-hidden="true" tabindex="-1"></a>  m1 <span class="ot">&lt;-</span> mu1 <span class="sc">+</span> rho<span class="sc">*</span>(x2<span class="sc">-</span>mu2)<span class="sc">*</span>sigma1<span class="sc">/</span>sigma2</span>
<span id="cb75-18"><a href="#cb75-18" aria-hidden="true" tabindex="-1"></a>  X[i,<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>,m1,s1)</span>
<span id="cb75-19"><a href="#cb75-19" aria-hidden="true" tabindex="-1"></a>  x1 <span class="ot">&lt;-</span> X[i,<span class="dv">1</span>]</span>
<span id="cb75-20"><a href="#cb75-20" aria-hidden="true" tabindex="-1"></a>  m2 <span class="ot">&lt;-</span> mu2 <span class="sc">+</span> rho<span class="sc">*</span>(x1<span class="sc">-</span>mu1)<span class="sc">*</span>sigma2<span class="sc">/</span>sigma1</span>
<span id="cb75-21"><a href="#cb75-21" aria-hidden="true" tabindex="-1"></a>  X[i,<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>,m2,s2)</span>
<span id="cb75-22"><a href="#cb75-22" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb75-23"><a href="#cb75-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-24"><a href="#cb75-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Remove the first 1000 observations and draw the graph generated by the sample</span></span>
<span id="cb75-25"><a href="#cb75-25" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> burn <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb75-26"><a href="#cb75-26" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> X[b<span class="sc">:</span>N, ]</span>
<span id="cb75-27"><a href="#cb75-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-28"><a href="#cb75-28" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x,<span class="at">main=</span><span class="st">&quot;&quot;</span>,<span class="at">cex=</span>.<span class="dv">5</span>,<span class="at">xlab=</span><span class="fu">bquote</span>(X[<span class="dv">1</span>]),<span class="at">ylab=</span><span class="fu">bquote</span>(X[<span class="dv">2</span>]),<span class="at">ylim=</span><span class="fu">range</span>(X[,<span class="dv">2</span>]))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a>lm <span class="ot">&lt;-</span> <span class="fu">lm</span>(x[,<span class="dv">1</span>]<span class="sc">~</span>x[,<span class="dv">2</span>])</span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lm)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = x[, 1] ~ x[, 2])
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -1.51967 -0.30047 -0.00191  0.29841  1.40225 
## 
## Coefficients:
##               Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) -0.0008946  0.0070843  -0.126      0.9    
## x[, 2]       0.8909244  0.0070041 127.201   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.4475 on 3998 degrees of freedom
## Multiple R-squared:  0.8019, Adjusted R-squared:  0.8018 
## F-statistic: 1.618e+04 on 1 and 3998 DF,  p-value: &lt; 2.2e-16</code></pre>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(x)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- -->
we can see p-value is very small and the fitting is very good. The mean
and variance are close to the real parameters</p>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a>Gelman.Rubin <span class="ot">&lt;-</span> <span class="cf">function</span>(psi){</span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># psi[i,j] is the statistic psi(X[i,1:j])</span></span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># for chain in i_th row of X</span></span>
<span id="cb79-4"><a href="#cb79-4" aria-hidden="true" tabindex="-1"></a>  pis <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(psi)</span>
<span id="cb79-5"><a href="#cb79-5" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">ncol</span>(psi)</span>
<span id="cb79-6"><a href="#cb79-6" aria-hidden="true" tabindex="-1"></a>  k <span class="ot">&lt;-</span> <span class="fu">nrow</span>(psi)</span>
<span id="cb79-7"><a href="#cb79-7" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb79-8"><a href="#cb79-8" aria-hidden="true" tabindex="-1"></a>  psi.means <span class="ot">&lt;-</span> <span class="fu">rowMeans</span>(psi)</span>
<span id="cb79-9"><a href="#cb79-9" aria-hidden="true" tabindex="-1"></a>  B <span class="ot">&lt;-</span> n<span class="sc">*</span><span class="fu">var</span>(psi.means)</span>
<span id="cb79-10"><a href="#cb79-10" aria-hidden="true" tabindex="-1"></a>  psi.w <span class="ot">&lt;-</span> <span class="fu">apply</span>(psi,<span class="dv">1</span>,<span class="st">&quot;var&quot;</span>)</span>
<span id="cb79-11"><a href="#cb79-11" aria-hidden="true" tabindex="-1"></a>  W <span class="ot">&lt;-</span> <span class="fu">mean</span>(psi.w)</span>
<span id="cb79-12"><a href="#cb79-12" aria-hidden="true" tabindex="-1"></a>  v.hat <span class="ot">&lt;-</span> W<span class="sc">*</span>(n<span class="dv">-1</span>)<span class="sc">/</span>n <span class="sc">+</span> (B<span class="sc">/</span>n)</span>
<span id="cb79-13"><a href="#cb79-13" aria-hidden="true" tabindex="-1"></a>  r.hat <span class="ot">&lt;-</span> v.hat <span class="sc">/</span> W            <span class="co"># G-R statistic</span></span>
<span id="cb79-14"><a href="#cb79-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(r.hat)</span>
<span id="cb79-15"><a href="#cb79-15" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb79-16"><a href="#cb79-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-17"><a href="#cb79-17" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="dv">4</span></span>
<span id="cb79-18"><a href="#cb79-18" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb79-19"><a href="#cb79-19" aria-hidden="true" tabindex="-1"></a>sigma <span class="ot">&lt;-</span> <span class="fl">0.6</span></span>
<span id="cb79-20"><a href="#cb79-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-21"><a href="#cb79-21" aria-hidden="true" tabindex="-1"></a><span class="co"># choose overdispersed initial values</span></span>
<span id="cb79-22"><a href="#cb79-22" aria-hidden="true" tabindex="-1"></a>x0 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">10</span>,<span class="sc">-</span><span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">10</span>)</span>
<span id="cb79-23"><a href="#cb79-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-24"><a href="#cb79-24" aria-hidden="true" tabindex="-1"></a><span class="co"># generate the chains</span></span>
<span id="cb79-25"><a href="#cb79-25" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>,<span class="at">nrow=</span>k,<span class="at">ncol=</span>N)</span>
<span id="cb79-26"><a href="#cb79-26" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k){</span>
<span id="cb79-27"><a href="#cb79-27" aria-hidden="true" tabindex="-1"></a>  X[i,] <span class="ot">&lt;-</span> <span class="fu">mh</span>(sigma,N,x0[i])<span class="sc">$</span>x</span>
<span id="cb79-28"><a href="#cb79-28" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb79-29"><a href="#cb79-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-30"><a href="#cb79-30" aria-hidden="true" tabindex="-1"></a><span class="co"># compute diagnostic statistics</span></span>
<span id="cb79-31"><a href="#cb79-31" aria-hidden="true" tabindex="-1"></a>psi <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">apply</span>(X,<span class="dv">1</span>,cumsum))</span>
<span id="cb79-32"><a href="#cb79-32" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(psi))</span>
<span id="cb79-33"><a href="#cb79-33" aria-hidden="true" tabindex="-1"></a>  psi[i,] <span class="ot">&lt;-</span> psi[i,]<span class="sc">/</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(psi))</span>
<span id="cb79-34"><a href="#cb79-34" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">Gelman.Rubin</span>(psi))</span></code></pre></div>
<pre><code>## [1] 1.293645</code></pre>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="co">#plot the sequence of R-hat statistics</span></span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a>rhat <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>,N)</span>
<span id="cb81-3"><a href="#cb81-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(j <span class="cf">in</span> (b<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>N)</span>
<span id="cb81-4"><a href="#cb81-4" aria-hidden="true" tabindex="-1"></a>  rhat[j] <span class="ot">&lt;-</span> <span class="fu">Gelman.Rubin</span>(psi[,<span class="dv">1</span><span class="sc">:</span>j])</span>
<span id="cb81-5"><a href="#cb81-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rhat[(b<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>N],<span class="at">type=</span><span class="st">&quot;l&quot;</span>,<span class="at">xlab=</span><span class="st">&quot;&quot;</span>,<span class="at">ylab=</span><span class="st">&quot;R&quot;</span>)</span>
<span id="cb81-6"><a href="#cb81-6" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span><span class="fl">1.2</span>,<span class="at">lty=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
</div>
<div id="a-22077-2022-11-04" class="section level1">
<h1>A-22077-2022-11-04</h1>
<div id="question-1-3" class="section level2">
<h2>Question 1</h2>
<p>Set up a random simulation study to examine the performance of the
above three permutation test methods</p>
</div>
<div id="answer-1-3" class="section level2">
<h2>Answer 1</h2>
<p>consider model <span class="math display">\[M=a_M+\alpha
X+e_M\]</span> and <span class="math display">\[ Y=a_Y+ \beta M +\gamma
X+e_Y\]</span> Consider three parameter combinations: <span class="math inline">\(\alpha=0,\beta=0\)</span>;<span class="math inline">\(\alpha=0,\beta=1\)</span>; <span class="math inline">\(\alpha=1,\beta=0\)</span> ,and use permutation
test.</p>
<p>Compare the quality of the test by comparing the p value</p>
</div>
<div id="question-2-1" class="section level2">
<h2>Question 2</h2>
<p>Consider model <span class="math display">\[
P(Y=1|x1,x2,x3)=expit(\alpha+b_1x_1+b_2x_2+b_3x_3)\]</span> with <span class="math inline">\(x_1~P(1),x_2~Exp(1),x_3~B(1,0.5)\)</span> write a
function to calculate alpha with N,b1,x1,x2,x3,f0. And use the function
with N=1e6,b1=0,b2=1,b3=-1,f0=0.1, 0.01, 0.001, 0.0001, and draw f0 vs
alpha</p>
</div>
<div id="answer-2-3" class="section level2">
<h2>Answer 2</h2>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">22077</span>)</span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a>root <span class="ot">&lt;-</span> <span class="cf">function</span>(N,b1,b2,b3,f0){</span>
<span id="cb82-3"><a href="#cb82-3" aria-hidden="true" tabindex="-1"></a>  x1 <span class="ot">&lt;-</span> <span class="fu">rpois</span>(N,<span class="dv">1</span>); x2 <span class="ot">&lt;-</span> <span class="fu">rexp</span>(N,<span class="dv">1</span>); x3 <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(N,<span class="dv">1</span>,<span class="fl">0.5</span>)</span>
<span id="cb82-4"><a href="#cb82-4" aria-hidden="true" tabindex="-1"></a>  g <span class="ot">&lt;-</span> <span class="cf">function</span>(alpha){</span>
<span id="cb82-5"><a href="#cb82-5" aria-hidden="true" tabindex="-1"></a>    tmp <span class="ot">&lt;-</span> <span class="fu">exp</span>(alpha<span class="sc">+</span>b1<span class="sc">*</span>x1<span class="sc">+</span>b2<span class="sc">*</span>x2<span class="sc">+</span>b3<span class="sc">*</span>x3)</span>
<span id="cb82-6"><a href="#cb82-6" aria-hidden="true" tabindex="-1"></a>    p <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span>(<span class="dv">1</span><span class="sc">+</span>tmp)</span>
<span id="cb82-7"><a href="#cb82-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mean</span>(p) <span class="sc">-</span> f0</span>
<span id="cb82-8"><a href="#cb82-8" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb82-9"><a href="#cb82-9" aria-hidden="true" tabindex="-1"></a>  solution <span class="ot">&lt;-</span> <span class="fu">uniroot</span>(g,<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">10</span>))</span>
<span id="cb82-10"><a href="#cb82-10" aria-hidden="true" tabindex="-1"></a>  solution<span class="sc">$</span>root</span>
<span id="cb82-11"><a href="#cb82-11" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb82-12"><a href="#cb82-12" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="fl">1e6</span>; b1 <span class="ot">&lt;-</span> <span class="dv">0</span>; b2 <span class="ot">&lt;-</span> <span class="dv">1</span>; b3  <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">1</span>; f0 <span class="ot">&lt;-</span><span class="fu">c</span>(.<span class="dv">1</span>,.<span class="dv">01</span>,.<span class="dv">001</span>,.<span class="dv">0001</span>)</span>
<span id="cb82-13"><a href="#cb82-13" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="dv">4</span>)</span>
<span id="cb82-14"><a href="#cb82-14" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>){</span>
<span id="cb82-15"><a href="#cb82-15" aria-hidden="true" tabindex="-1"></a>  alpha[i] <span class="ot">&lt;-</span> <span class="fu">root</span>(N,b1,b2,b3,f0[i])</span>
<span id="cb82-16"><a href="#cb82-16" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb82-17"><a href="#cb82-17" aria-hidden="true" tabindex="-1"></a>alpha</span></code></pre></div>
<pre><code>## [1] 2.060291 4.516605 6.833126 9.136838</code></pre>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(f0,alpha,<span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.1</span>),<span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">10</span>))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
</div>
<div id="a-22077-2022-11-11" class="section level1">
<h1>A-22077-2022-11-11</h1>
<div id="question-1-4" class="section level2">
<h2>Question 1</h2>
<p>let <span class="math inline">\(X_1,X_2,...,X_n\)</span> <span class="math inline">\(i.i.d.\sim\)</span> <span class="math inline">\(Exp(\lambda)\)</span>. We know that <span class="math inline">\(X_i\)</span> is located in (<span class="math inline">\(u_i,v_i\)</span>), where <span class="math inline">\(u_,v_i\)</span> are two known certain constants.
(1)maximize the likelihood function of observated data and use EM
algorithm to solve the <span class="math inline">\(MLE\)</span> of <span class="math inline">\(\lambda\)</span>respectively, and prove that they
are equal. (2)Set the observation value of <span class="math inline">\((u_i,v_i)\)</span> as <span class="math inline">\((11,12),(8,9),(27,28),(13,14),(16,17),(0,1),(23,24),(10,11),(24,25),(2,3)\)</span>.Use
the two methods to calculate MLE.</p>
</div>
<div id="answer-1-4" class="section level2">
<h2>Answer 1</h2>
<p>The likelihood function is <span class="math display">\[
L(\lambda)=\prod_{i=1}^{n}(e^{-\lambda u_i}-e^{-\lambda v_i})\]</span>
thus <span class="math display">\[ l(\lambda)=ln L(\lambda)
=\sum_{i=1}^{n} ln (e^{-\lambda u_i}-e^{-\lambda v_i})\]</span> and let
<span class="math inline">\(\partial l(\lambda)/ \partial \lambda
=0\)</span>, then we can get <span class="math inline">\(\hat\lambda\)</span></p>
<p>program to calculate <span class="math inline">\(\hat\lambda\)</span></p>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a>u <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">11</span>,<span class="dv">8</span>,<span class="dv">27</span>,<span class="dv">13</span>,<span class="dv">16</span>,<span class="dv">0</span>,<span class="dv">23</span>,<span class="dv">10</span>,<span class="dv">24</span>,<span class="dv">2</span>)</span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a>v <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">12</span>,<span class="dv">9</span>,<span class="dv">28</span>,<span class="dv">14</span>,<span class="dv">17</span>,<span class="dv">1</span>,<span class="dv">24</span>,<span class="dv">11</span>,<span class="dv">25</span>,<span class="dv">3</span>)</span>
<span id="cb85-3"><a href="#cb85-3" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="dv">10</span>)</span>
<span id="cb85-4"><a href="#cb85-4" aria-hidden="true" tabindex="-1"></a>obj <span class="ot">&lt;-</span> <span class="cf">function</span>(lambda,u,v){</span>
<span id="cb85-5"><a href="#cb85-5" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span> <span class="dv">10</span>){</span>
<span id="cb85-6"><a href="#cb85-6" aria-hidden="true" tabindex="-1"></a>    x[i] <span class="ot">&lt;-</span> (v[i]<span class="sc">-</span>u[i])<span class="sc">/</span>(<span class="fu">exp</span>(lambda<span class="sc">*</span>(v[i]<span class="sc">-</span>u[i])))<span class="sc">-</span>u[i]</span>
<span id="cb85-7"><a href="#cb85-7" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb85-8"><a href="#cb85-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sum</span>(x)</span>
<span id="cb85-9"><a href="#cb85-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb85-10"><a href="#cb85-10" aria-hidden="true" tabindex="-1"></a>u <span class="ot">&lt;-</span> <span class="fu">uniroot</span>(obj,<span class="at">lower=</span><span class="sc">-</span><span class="dv">10</span>,<span class="at">upper=</span><span class="dv">10</span>,<span class="at">u=</span> u,<span class="at">v=</span> v)</span>
<span id="cb85-11"><a href="#cb85-11" aria-hidden="true" tabindex="-1"></a>lambda.hat <span class="ot">&lt;-</span> u<span class="sc">$</span>root</span>
<span id="cb85-12"><a href="#cb85-12" aria-hidden="true" tabindex="-1"></a>lambda.hat</span></code></pre></div>
<pre><code>## [1] -2.595255</code></pre>
</div>
<div id="question-2-2" class="section level2">
<h2>Question 2</h2>
<p>Why do you need to use unlist() to convert a list to an atomic
vector? Why doesn’t as.vector() work?</p>
</div>
<div id="answer-2-4" class="section level2">
<h2>Answer 2</h2>
<p>Because all elements of an atomic vector must be the same type,
whereas the elements of a list can have different types. If we use
as.vector,we may lose some informations.</p>
</div>
<div id="question-3-1" class="section level2">
<h2>Question 3</h2>
<p>Why is 1 == “1” true? Why is -1 &lt; FALSE true? Why is “one” &lt; 2
false?</p>
</div>
<div id="answer-3-1" class="section level2">
<h2>Answer 3</h2>
<p>When we attempt to combine different types they will be coerced to
the most flexible type. when we use “==”, 1 will be coerced to “1”,so it
is correct;</p>
<p>When a logical vector is coerced to an integer or double, TRUE
becomes 1 and FALSE becomes 0,so when we use -1&lt; FALSE,it is same
with -1&lt;0, so it is true; “one” is character type and it is more
flexible than double type, so “one” &lt; 2 is false.</p>
</div>
<div id="question-4" class="section level2">
<h2>Question 4</h2>
<p>What does “dim()” return when applied to a vector?</p>
</div>
<div id="answer-4-1" class="section level2">
<h2>Answer 4</h2>
<p>It will return NULL;if we want to get the length of a vector, we
should use “length()”.</p>
</div>
<div id="question-5" class="section level2">
<h2>Question 5</h2>
<p>If is.matrix(x) is TRUE, what will is.array(x) return?</p>
</div>
<div id="answer-5" class="section level2">
<h2>Answer 5</h2>
<p>It will return TRUE,because a matrix is also an array.</p>
</div>
<div id="question-6" class="section level2">
<h2>Question 6</h2>
<p>What attributes does a data frame possess?</p>
</div>
<div id="answer-6" class="section level2">
<h2>Answer 6</h2>
<p>Column names should not be empty.</p>
<p>Row names should be unique.</p>
<p>The data stored in the data frame can be of number, factor or
character type.</p>
<p>Each column should contain the same number of data items.</p>
</div>
<div id="question-7" class="section level2">
<h2>Question 7</h2>
<p>What does as.matrix() do when applied to a data frame with columns of
different types?</p>
</div>
<div id="answer-7" class="section level2">
<h2>Answer 7</h2>
<p>It will return a matrix with the data of the data frame.</p>
</div>
<div id="question-8" class="section level2">
<h2>Question 8</h2>
<p>Can you have a data frame with 0 rows? What about 0 columns?</p>
</div>
<div id="answer-8" class="section level2">
<h2>Answer 8</h2>
<p>If we create a data frame with nothing,it will show that we get a
data frame with 0 rows.</p>
</div>
</div>
<div id="a-22077-2022-11-11-1" class="section level1">
<h1>A-22077-2022-11-11</h1>
</div>
<div id="question-1-5" class="section level1">
<h1>Question 1</h1>
<p>The function below scales a vector so it falls in the range [0, 1].
How would you apply it to every column of a data frame? How would you
apply it to every numeric column in a data frame?</p>
</div>
<div id="answer-1-5" class="section level1">
<h1>Answer 1</h1>
<div id="a-1" class="section level2">
<h2>a)</h2>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a>scale01 <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a>rng <span class="ot">&lt;-</span> <span class="fu">range</span>(x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb87-3"><a href="#cb87-3" aria-hidden="true" tabindex="-1"></a>(x <span class="sc">-</span> rng[<span class="dv">1</span>]) <span class="sc">/</span> (rng[<span class="dv">2</span>] <span class="sc">-</span> rng[<span class="dv">1</span>])</span>
<span id="cb87-4"><a href="#cb87-4" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb87-5"><a href="#cb87-5" aria-hidden="true" tabindex="-1"></a>beauty<span class="ot">&lt;-</span><span class="fu">data.frame</span>(<span class="at">x=</span><span class="dv">0</span><span class="sc">:</span><span class="dv">4</span>,<span class="at">y=</span><span class="dv">6</span><span class="sc">:</span><span class="dv">10</span>)</span>
<span id="cb87-6"><a href="#cb87-6" aria-hidden="true" tabindex="-1"></a><span class="fu">lapply</span>(beauty,scale01)</span></code></pre></div>
<pre><code>## $x
## [1] 0.00 0.25 0.50 0.75 1.00
## 
## $y
## [1] 0.00 0.25 0.50 0.75 1.00</code></pre>
</div>
<div id="b" class="section level2">
<h2>b)</h2>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a>beauty<span class="ot">&lt;-</span><span class="fu">data.frame</span>(<span class="at">x=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.5</span>,<span class="fl">0.7</span>,<span class="fl">0.9</span>,<span class="fl">0.5</span>),<span class="at">y=</span><span class="fu">c</span>(<span class="dv">6</span>,<span class="dv">7</span>,<span class="dv">8</span>,<span class="dv">9</span>,<span class="dv">10</span>),<span class="at">z=</span><span class="fu">c</span>(<span class="st">&#39;a&#39;</span>,<span class="st">&#39;b&#39;</span>,<span class="st">&#39;c&#39;</span>,<span class="st">&#39;d&#39;</span>,<span class="st">&#39;e&#39;</span>))</span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a>a <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">0</span>)</span>
<span id="cb89-3"><a href="#cb89-3" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(beauty)) {</span>
<span id="cb89-4"><a href="#cb89-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">class</span>(beauty[,i])<span class="sc">!=</span><span class="st">&#39;numeric&#39;</span>) a<span class="ot">=</span><span class="fu">c</span>(a,i) </span>
<span id="cb89-5"><a href="#cb89-5" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb89-6"><a href="#cb89-6" aria-hidden="true" tabindex="-1"></a>beauty1 <span class="ot">=</span> beauty[,<span class="sc">-</span>a]</span>
<span id="cb89-7"><a href="#cb89-7" aria-hidden="true" tabindex="-1"></a>scale01 <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb89-8"><a href="#cb89-8" aria-hidden="true" tabindex="-1"></a>rng <span class="ot">&lt;-</span> <span class="fu">range</span>(x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb89-9"><a href="#cb89-9" aria-hidden="true" tabindex="-1"></a>(x <span class="sc">-</span> rng[<span class="dv">1</span>]) <span class="sc">/</span> (rng[<span class="dv">2</span>] <span class="sc">-</span> rng[<span class="dv">1</span>])</span>
<span id="cb89-10"><a href="#cb89-10" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb89-11"><a href="#cb89-11" aria-hidden="true" tabindex="-1"></a><span class="fu">lapply</span>(beauty1,scale01)</span></code></pre></div>
<pre><code>## $x
## [1] 0.0000000 0.5555556 0.7777778 1.0000000 0.5555556
## 
## $y
## [1] 0.00 0.25 0.50 0.75 1.00</code></pre>
</div>
</div>
<div id="question-2-3" class="section level1">
<h1>Question 2</h1>
<p>Use vapply() to: a) Compute the standard deviation of every column in
a nu- meric data frame. b) Compute the standard deviation of every
numeric column in a mixed data frame. (Hint: you’ll need to use vapply()
twice.)</p>
<div id="a-2" class="section level2">
<h2>a)</h2>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a>beauty<span class="ot">&lt;-</span><span class="fu">data.frame</span>(<span class="at">x=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.5</span>,<span class="fl">0.7</span>,<span class="fl">0.9</span>,<span class="fl">0.5</span>),<span class="at">y=</span><span class="fu">c</span>(<span class="dv">6</span>,<span class="dv">7</span>,<span class="dv">8</span>,<span class="dv">9</span>,<span class="dv">10</span>))</span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a><span class="fu">vapply</span>(beauty,sd,<span class="fu">c</span>(<span class="dv">1</span>))</span></code></pre></div>
<pre><code>##        x        y 
## 0.334664 1.581139</code></pre>
</div>
<div id="b-1" class="section level2">
<h2>b)</h2>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a>beauty<span class="ot">&lt;-</span><span class="fu">data.frame</span>(<span class="at">x=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.5</span>,<span class="fl">0.7</span>,<span class="fl">0.9</span>,<span class="fl">0.5</span>),<span class="at">y=</span><span class="fu">c</span>(<span class="dv">6</span>,<span class="dv">7</span>,<span class="dv">8</span>,<span class="dv">9</span>,<span class="dv">10</span>),<span class="at">z=</span><span class="fu">c</span>(<span class="st">&#39;a&#39;</span>,<span class="st">&#39;b&#39;</span>,<span class="st">&#39;c&#39;</span>,<span class="st">&#39;d&#39;</span>,<span class="st">&#39;e&#39;</span>))</span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span><span class="fu">vapply</span>(beauty,is.numeric,<span class="fu">c</span>(<span class="dv">1</span>))</span>
<span id="cb93-3"><a href="#cb93-3" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span><span class="fu">c</span>(<span class="dv">0</span>)</span>
<span id="cb93-4"><a href="#cb93-4" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(a)) {</span>
<span id="cb93-5"><a href="#cb93-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">class</span>(a[i])<span class="sc">!=</span><span class="st">&#39;numeric&#39;</span>) b<span class="ot">=</span><span class="fu">c</span>(b,i) </span>
<span id="cb93-6"><a href="#cb93-6" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb93-7"><a href="#cb93-7" aria-hidden="true" tabindex="-1"></a>beauty1 <span class="ot">=</span> beauty[,<span class="sc">-</span>b]</span>
<span id="cb93-8"><a href="#cb93-8" aria-hidden="true" tabindex="-1"></a><span class="fu">vapply</span>(beauty1,sd,<span class="fu">c</span>(<span class="dv">1</span>))</span></code></pre></div>
<pre><code>## named numeric(0)</code></pre>
</div>
</div>
<div id="question-3-2" class="section level1">
<h1>Question 3</h1>
<p>Implement a Gibbs sampler to generate a bivariate normal chain (Xt,
Yt) with zero means, unit standard deviations, and correlation 0.9. •
Write an Rcpp function. • Compare the corresponding generated random
numbers with pure R language using the function “qqplot”. • Compare the
computation time of the two functions with the function
“microbenchmark”.</p>
</div>
<div id="answer-3-2" class="section level1">
<h1>Answer 3</h1>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(Rcpp)</span>
<span id="cb95-2"><a href="#cb95-2" aria-hidden="true" tabindex="-1"></a>dir_cpp <span class="ot">&lt;-</span> <span class="st">&#39;../Rcpp/&#39;</span></span>
<span id="cb95-3"><a href="#cb95-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Can create source file in Rstudio</span></span>
<span id="cb95-4"><a href="#cb95-4" aria-hidden="true" tabindex="-1"></a><span class="fu">sourceCpp</span>(<span class="st">&#39;D:/meanC.cpp&#39;</span>)</span>
<span id="cb95-5"><a href="#cb95-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(microbenchmark)</span>
<span id="cb95-6"><a href="#cb95-6" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="fl">1e4</span>); mean2 <span class="ot">&lt;-</span> <span class="cf">function</span>(x)<span class="fu">sum</span>(x)<span class="sc">/</span><span class="fu">length</span>(x)</span>
<span id="cb95-7"><a href="#cb95-7" aria-hidden="true" tabindex="-1"></a>ts <span class="ot">&lt;-</span> <span class="fu">microbenchmark</span>(<span class="at">meanR=</span><span class="fu">mean</span>(x),<span class="at">meanR2=</span><span class="fu">mean2</span>(x),</span>
<span id="cb95-8"><a href="#cb95-8" aria-hidden="true" tabindex="-1"></a><span class="at">meancpp=</span><span class="fu">meanC</span>(x))</span>
<span id="cb95-9"><a href="#cb95-9" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(ts)[,<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">6</span>)]</span></code></pre></div>
<pre><code>##      expr   lq median   uq
## 1   meanR 20.6   20.7 20.9
## 2  meanR2  8.4    8.5  8.6
## 3 meancpp 11.6   11.8 11.9</code></pre>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">5000</span></span>
<span id="cb97-2"><a href="#cb97-2" aria-hidden="true" tabindex="-1"></a>burn <span class="ot">&lt;-</span> <span class="dv">1000</span> <span class="co"># burn-in length</span></span>
<span id="cb97-3"><a href="#cb97-3" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>,N,<span class="dv">2</span>)</span>
<span id="cb97-4"><a href="#cb97-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-5"><a href="#cb97-5" aria-hidden="true" tabindex="-1"></a>rho <span class="ot">&lt;-</span><span class="fl">0.9</span> <span class="co"># correlation</span></span>
<span id="cb97-6"><a href="#cb97-6" aria-hidden="true" tabindex="-1"></a>mu1 <span class="ot">&lt;-</span> mu2 <span class="ot">&lt;-</span><span class="dv">0</span></span>
<span id="cb97-7"><a href="#cb97-7" aria-hidden="true" tabindex="-1"></a>sigma1 <span class="ot">&lt;-</span> sigma2 <span class="ot">&lt;-</span><span class="dv">1</span></span>
<span id="cb97-8"><a href="#cb97-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-9"><a href="#cb97-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-10"><a href="#cb97-10" aria-hidden="true" tabindex="-1"></a><span class="co"># generate the chain</span></span>
<span id="cb97-11"><a href="#cb97-11" aria-hidden="true" tabindex="-1"></a>gibbs_r <span class="ot">&lt;-</span> <span class="cf">function</span>(N,burn,X,rho,mu1,mu2,sigma1,sigma2){</span>
<span id="cb97-12"><a href="#cb97-12" aria-hidden="true" tabindex="-1"></a>  s1 <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="dv">1</span><span class="sc">-</span>rho<span class="sc">^</span><span class="dv">2</span>)<span class="sc">*</span>sigma1</span>
<span id="cb97-13"><a href="#cb97-13" aria-hidden="true" tabindex="-1"></a>  s2 <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="dv">1</span><span class="sc">-</span>rho<span class="sc">^</span><span class="dv">2</span>)<span class="sc">*</span>sigma2</span>
<span id="cb97-14"><a href="#cb97-14" aria-hidden="true" tabindex="-1"></a>  X[<span class="dv">1</span>,] <span class="ot">&lt;-</span> <span class="fu">c</span>(mu1,mu2)</span>
<span id="cb97-15"><a href="#cb97-15" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>N){</span>
<span id="cb97-16"><a href="#cb97-16" aria-hidden="true" tabindex="-1"></a>    x2 <span class="ot">&lt;-</span> X[i<span class="dv">-1</span>,<span class="dv">2</span>]</span>
<span id="cb97-17"><a href="#cb97-17" aria-hidden="true" tabindex="-1"></a>    m1 <span class="ot">&lt;-</span> mu1<span class="sc">+</span>rho<span class="sc">*</span>(x2<span class="sc">-</span>mu2)<span class="sc">*</span>sigma1<span class="sc">/</span>sigma2</span>
<span id="cb97-18"><a href="#cb97-18" aria-hidden="true" tabindex="-1"></a>    X[i,<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>,m1,s1)</span>
<span id="cb97-19"><a href="#cb97-19" aria-hidden="true" tabindex="-1"></a>    x1 <span class="ot">&lt;-</span> X[i,<span class="dv">1</span>]</span>
<span id="cb97-20"><a href="#cb97-20" aria-hidden="true" tabindex="-1"></a>    m2 <span class="ot">&lt;-</span> mu2<span class="sc">+</span>rho<span class="sc">*</span>(x1<span class="sc">-</span>mu1)<span class="sc">*</span>sigma2<span class="sc">/</span>sigma1</span>
<span id="cb97-21"><a href="#cb97-21" aria-hidden="true" tabindex="-1"></a>    X[i,<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>,m2,s2)</span>
<span id="cb97-22"><a href="#cb97-22" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb97-23"><a href="#cb97-23" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb97-24"><a href="#cb97-24" aria-hidden="true" tabindex="-1"></a>  b <span class="ot">&lt;-</span> burn <span class="sc">+</span><span class="dv">1</span> </span>
<span id="cb97-25"><a href="#cb97-25" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> X[b<span class="sc">:</span>N,]</span>
<span id="cb97-26"><a href="#cb97-26" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb97-27"><a href="#cb97-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-28"><a href="#cb97-28" aria-hidden="true" tabindex="-1"></a>x1 <span class="ot">&lt;-</span> <span class="fu">gibbs_r</span>(N,burn,X,rho,mu1,mu2,sigma1,sigma2)</span></code></pre></div>
<p>use Rcpp to generate:</p>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">5000</span></span>
<span id="cb98-2"><a href="#cb98-2" aria-hidden="true" tabindex="-1"></a>burn <span class="ot">&lt;-</span> <span class="dv">1000</span> <span class="co"># burn-in length</span></span>
<span id="cb98-3"><a href="#cb98-3" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>,N,<span class="dv">2</span>)</span>
<span id="cb98-4"><a href="#cb98-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-5"><a href="#cb98-5" aria-hidden="true" tabindex="-1"></a>rho <span class="ot">&lt;-</span><span class="fl">0.9</span> <span class="co"># correlation</span></span>
<span id="cb98-6"><a href="#cb98-6" aria-hidden="true" tabindex="-1"></a>mu1 <span class="ot">&lt;-</span> mu2 <span class="ot">&lt;-</span><span class="dv">0</span></span>
<span id="cb98-7"><a href="#cb98-7" aria-hidden="true" tabindex="-1"></a>sigma1 <span class="ot">&lt;-</span> sigma2 <span class="ot">&lt;-</span><span class="dv">1</span></span>
<span id="cb98-8"><a href="#cb98-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(Rcpp)</span>
<span id="cb98-9"><a href="#cb98-9" aria-hidden="true" tabindex="-1"></a><span class="fu">sourceCpp</span>(<span class="st">&#39;D:/gibbs_cpp.cpp&#39;</span>)</span>
<span id="cb98-10"><a href="#cb98-10" aria-hidden="true" tabindex="-1"></a>x2 <span class="ot">&lt;-</span> <span class="fu">gibbs_cpp</span>(N,mu1,mu2,sigma1,sigma2,rho)</span></code></pre></div>
<p>Compare the corresponding generated random numbers with pure R
language using the function “qqplot”</p>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qqplot</span>(x1,x2)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Compare the computation time of the two functions with the function
“microbenchmark”</p>
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(microbenchmark)</span>
<span id="cb100-2"><a href="#cb100-2" aria-hidden="true" tabindex="-1"></a><span class="fu">microbenchmark</span>(<span class="fu">gibbs_r</span>(N,burn,X,rho,mu1,mu2,sigma1,sigma2),<span class="fu">gibbs_cpp</span>(N,mu1,mu2,sigma1,sigma2,rho))</span></code></pre></div>
<pre><code>## Unit: milliseconds
##                                                expr     min      lq      mean
##  gibbs_r(N, burn, X, rho, mu1, mu2, sigma1, sigma2) 15.4085 17.3599 21.562692
##         gibbs_cpp(N, mu1, mu2, sigma1, sigma2, rho)  1.0827  1.1249  1.295761
##    median       uq     max neval
##  20.32490 23.25540 80.4897   100
##   1.17785  1.27145  6.1323   100</code></pre>
<p>we can see gibbs_cpp use less time.</p>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
